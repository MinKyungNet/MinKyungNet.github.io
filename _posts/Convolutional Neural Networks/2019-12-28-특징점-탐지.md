---
layout: post
title: "특징점 탐지"
tags: [landmark detection]
categories: [Convolutional Neural Networks]
---

# 학습 목표
- 특징점 탐지에 대해 알아본다.

# 핵심 키워드
- 특징점 탐지

# 학습 내용
- 여러개의 특정점을 포함하는 레이블 훈련 세트를 만들어 신경망으로 하여금 어디에 특징점들이 있는지 말할 수 있게 학습 시킬 수 있습니다.
- 다만 훈련시키려고 하는 모든 이미지에서 사람이 지정한 특징점의 정의는 같아야합니다.

# 로컬라이제이션
![image](https://user-images.githubusercontent.com/50114210/71539158-b43f8780-297b-11ea-8c7e-578dff3f44d7.png)              
이전 글에서 어떻게 신경망이 네 개의 출력을 얻는지 보았습니다         
b_x, b_y, b_h, b_w였는데요        
신경망에서 위치를 알아내고자 하는 물체의 경계 상자를 표현하는 값이죠        
일반적으로 신경망은 xy좌표를 가지는데          
이미지에서 주로 특징점이라고 불리는 주요한 지점을 나타냅니다        
이것을 신경망으로 인식하고자 하는 것이죠 몇 가지 예시를 보도록 하겠습니다        

# 얼굴 인식
![image](https://user-images.githubusercontent.com/50114210/71539164-cb7e7500-297b-11ea-8bcc-6922364a28bf.png)                     
여러분이 얼굴 인식 시스템을 설계한다고 해보겠습니다            
우리는 알고리즘이 눈꼬리 위치를 찾아줄 수 있기를 바라고 있습니다           
이 위치는 xy좌표를 가지기 때문에 신경망은 마지막 층에서 두 개의 출력을 가지게 됩니다           
이것을 l_x, l_y라고 하고 눈꼬리 위치의 좌표를 표현하는 것이죠           
그럼 두 눈에 있는 네 개의 눈꼬리를 모두 표현하려면 어떻게 할까요?           
왼쪽에서 오른쪽으로 각각 첫 번째, 두 번째, 세 번째, 네 번째라고 한다면           
신경망을 수정하여 출력값이 첫 번째 점은 l_1x, l_1y가 되고 두 번째 점은 l_2x, l_2y           
나머지도 그렇게 한다면 신경망은 사람의 얼굴에서 네 개의 점을 모두 찾아낼 수 있게 됩니다           
하지만 단지 이 네 개의 점만 원하는 것이 아니라면 어떨까요?           
출력으로 눈 위의 여기와 여기, 여기  그리고 여기의 점을 원한다면요?           
입에서의 점을 출력으로 가진다면 사람의 입 모양을 추출해서 웃거나 찡그리고 있는지 말할 수 있겠죠           
코의 윤곽을 따라 점을 추출할 수도 있습니다           
그리고 모양에 따라서 변수의 갯수를 설정할 수 있을 겁니다           
얼굴에 64개의 특징점을 정한다고 하면 몇 개의 점은 턱의 윤곽선을 결정할 수 있게 해줄 겁니다           
특징점들을 설정하고 이 특징점을 포함하는 레이블 훈련 세트를 만들면           
신경망이 어디에 특징점들이 있는지 말할 수 있도록 할 수 있습니다           
그러면 이 이미지에 대해서는  어떤식으로 될까요?           
사람의 얼굴을 입력으로 하고 합성곱 신경망을 통과하면           
합성곱 신경망을 통과한 후에 몇 가지 특성을 나타내는데           
먼저 얼굴이 있는지 없는지에 따라서 0 또는 1의 출력을 가집니다           
그리고 l_1x, l_1y 등등 이런 형태의 출력을 가지고 l_64x, l_64y까지 내려가죠           
l은 특징점을 표현하기 위해서 사용했습니다           
따라서 이 예시는 총 129개의 출력 유닛을 가집니다           
1개는 얼굴이 있는지 없는지를 표시하고 그리고 64개의 특징점이 있으므로           
64*2개의 유닛을 가집니다 따라서 128+1개의  출력 유닛을 가지는 것이죠           
이것은 얼굴의 유무와 얼굴의 모든 특징점을 표현합니다           
이것이 얼굴에서 감정을 인식하는 것의 기본적인 설계 단위인데요           
이것을 통해 만약 스냅챗이나 다른 엔터테인먼트를 사용한다면            
증강 현실 필터인 스냅챗 필터가 얼굴 위에 왕관을 그려주거나           
다른 특별한 효과를 줄 수 있는 것이죠           
이 특징점들을 검출하는 것은 컴퓨터 그래픽 효과에 있어서 중요한 부분입니다           
얼굴을 휘어지게 만들거나 다양한 효과를 그리는 것을 말하죠           
얼굴위에 왕관이나 모자 같은 것을 씌우는 것처럼요           
이러한 신경망을 훈련하기 위해서 레이블 훈련 세트가 필요합니다           
우리는 이미지 세트를 가지고 있고 레이블 y도 가지고 있습니다
이것에 대해선 누군가 모든 특징점들의 값을 구해야 하겠지요

# 자세감지
![image](https://user-images.githubusercontent.com/50114210/71539162-befa1c80-297b-11ea-9646-4210a1881bba.png)                   
마지막 예시에서는 자세 감지에 관한 것입니다             
여기서도 몇 개의 중요한 위치를 정할 수 있는데              
가슴의 중앙이나 왼쪽 어깨, 왼쪽 팔꿈치, 손목 등입니다             
신경망은 사람의 자세에서 각 중요 위치에 표시를 하게 될 것이고             
신경망의 출력으로 이 모든 지점이 표시되어 나올 것입니다             
또한 사람의 자세를 출력 값으로 얻게 될 것입니다             
이것을 하기 위해서 중요 특징점들을 정해야 합니다             
l_1x와 l_1y는 가슴의 중앙이 되고 계속해서 l_32x, l_32y까지 내려갑니다             
이 32개의 좌표를 사람의 자세를 정하는데 사용하는 것이죠              
이 개념은 상당히 간단해 보입니다             
여러 개의 출력 유닛을 추가해서 인식하고자 하는 특징점들의 각 좌표를 출력하는 것이죠             

# 주의사항             
이것을 확실하게 하기 위해서 특징점은 다른 이미지에 대해서도 항상 동일해야 합니다             
특징점 1은 항상  이 부분의 눈꼬리가 되어야 하죠             
그리고 특징점 2는  항상 이쪽의 눈꼬리가 되어야 합니다              
특징점3, 특징점4도 마찬가지입니다             
레이블 순서는 다른 이미지에 대해서도 항상 동일해야 합니다             
만약 여러분이 직접 레이블을 표시하거나 사람을 고용하여             
충분히 큰 데이터 세트를 표시한다면 신경망은 충분히 이 특징점들을              
모두 출력해낼 수 있을 겁니다             
그리고 이것을 이용해 다른 흥미로운 효과를 만들 수 있습니다             
사람의 자세를 추측하거나 사진을 보고 감정을 인식하는 것들 말이죠             

---
layout: post
title: "더 많은 모서리 감지 예시"
tags: [colvolution operation, kernel, filter, edge detection, verical edge, horigontal edge]
categories: [Convolutional Neural Networks]
---

# 학습 목표
- 더 많은 윤곽선 검출을 알아본다.

# 핵심 키워드
- 합성곱 연산
- 필터 / 커널
- 윤곽선 검출
- 수직 / 가로 윤곽선
- 수평 / 세로 윤곽선

# 학습 내용
![image](https://user-images.githubusercontent.com/50114210/71304974-dd5a9800-2410-11ea-8f9a-4e92838c1515.png)              
- 다양한 필터들
- 윤곽선을 탐지하려고 사람들이 연구한 sobel 필터, scharr 필터 등이 있습니다.
- 다양한 필터가 있지만, 최근 딥러닝에서는 임의의 숫자로 만든 다음에 역전파를 통해 알아서 학습시켜서 문제에 적합한 필터를 만드는 방법을 사용합니다.

# 인트로
지난 번에는 어떻게 합성곱 연산으로 세로 윤곽선 검출을 구현하는지를 살펴보았고             
이번 영상에서 살펴볼 것은 양과 음의 윤곽선의 차이 곧 서로 다른 밝기의 전환입니다               
또한 그 외에 다른 모서리 검출기와 지금 해오던 것처럼 수동으로 코딩하는 것이 아닌                    
스스로 배우는 알고리즘을 살펴볼 것입니다                      

# 지난번의 모서리 검출 예시
여기 저번 영상에서 살펴본 예시가 있습니다왼쪽은 밝고 오른쪽은 어두운 6 x 6 크기의 이미지였죠             
세로 윤곽선 검출기 필터와 합성곱 연산을 하게 되면 가운데의 세로 윤곽선을 찾아낼 수 있었습니다            
만약 이미지를 뒤집어서 왼쪽이 어둡고 오른쪽이 밝아서             
10 들이 이제는 오른쪽에 있고 0 은 왼쪽편에 있을 때 이것을 동일한 필터로 합성곱을 하면                       
30 대신 -30 을 얻게 됩니다 그림으로 표현하면 이런 형식이 되겠죠           
전환되는 순서가 바뀌었기 때문에 30 역시 뒤집힌 것입니다 -30 으로 말이죠             
그래서 어두운 곳에서 밝은 곳으로 가는 것으로 바뀐 것을 알 수 있습니다             
만약 두 종류의 차이를 신경쓰지 않는다면 결과 행렬에 절대값을 씌워줘도 됩니다                        
하지만 이 필터는 밝은 곳에서 어두운 곳으로 가는 것과 그 반대의 경우의 차이를 나타내 줍니다                

# 모서리 검출 예시 1
![image](https://user-images.githubusercontent.com/50114210/71305089-f7e14100-2411-11ea-975f-58146282662b.png)                                     
모서리 검출의 다른 예들을 살펴봅시다                   
여기 이 3 x 3 크기의 필터는 세로 윤곽선을 검출해냅니다                                   
그래서 여기 이 3 x 3 필터가 가로 윤곽선을 검출한다는 것이 크게 놀라운 일은 아니겠죠          
그래서 세로 윤곽선은 이 3 x 3 필터에 의하면 왼쪽이 상대적으로 밝고             
오른쪽이 상대적으로 어두운 부분이고 마찬가지로 비슷하게 수평윤곽선에서도             
3 x 3 영역에서 위쪽이 상대적으로 밝고 아래쪽이 상대적으로 어두운 것이죠                

# 모서리 검출 예시 2
![image](https://user-images.githubusercontent.com/50114210/71305092-029bd600-2412-11ea-8c73-508754a449b8.png)                          
여기 한 예가 있습니다 조금 더 복잡한 이미지인데 10 이 왼쪽 위와 오른쪽 아래에 있고             
이걸 이미지로 나타낸다면 알다시피 0 으로 표시된           
부분은 어두울 것이고 왼쪽 위와 오른쪽 아래는 밝게 표현될 것이고                       
가로 윤곽선 검출기를 사용한다면 이런 결과을 얻을 것입니다                            
확인차 또 살펴보자면여기 30 이라는 수가 나온 이유는                       
여기 3 x 3 영역에서 확실히 위쪽의 픽셀이 밝고 아래쪽은 어두워서죠            
강한 양의 윤곽선을 찾은 것이죠                    
그리고 이 -30 이라는 수는 이 부분에 해당합니다 아래쪽이 밝고 위쪽에 어두워서 음의 윤곽선이 되는 것이죠                  
역시나 이 예시는 실제보다 작은 이미지를 다룹니다               
6 x 6 크기 밖에 되지 않기 때문이죠 하지만 여기 있는 -10 같은 어중간한 값이 나온 이유는               
필터가 그 부분에서 왼쪽에 있는 양의 윤곽선과 오른쪽에 있는 음의 윤곽선 모두를 인식해서               
두 개가 섞여서 이런 중간 크기의 값이 나온 것이죠                
하지만 만약 이미지가 1000 x 1000 의 이런 바둑판 같은 이미지였다면               
이런 중간값이 상대적으로 작아서 눈에 띄지 않을 것입니다             
그래서 서로 다른 필터는 세로 또는 가로의 윤곽선을 검출해냅니다                          

# 전통적인 필터
![image](https://user-images.githubusercontent.com/50114210/71305097-0e879800-2412-11ea-8f99-08c752001e1d.png)                           
우리가 사용한 3 x 3 세로 윤곽선 검출기는 그저 여러 개 중 하나의 가능성입니다           
역사적으로 컴퓨터 비전의 분야에서는 어떤 숫자의 조합을 사용해야 할지에 대해 논쟁이 있었습니다               
그래서  1 2 1 0 0 0 -1 -2 -1 을 사용할 수 있는데 이것을 소벨 필터라고 합니다              
이 필터의 장점은 중간 부분의 픽셀에 더 중점을 둔다는 것입니다             
그래서 더 선명해 보이겠죠 컴퓨터 비전을 연구하는 사람들은 다른 숫자를 사용하기도 합니다              
1 2 1 대신 3 10 3 과 -3 -10 -3 을 사용하고 이것을 Scharr 필터라고 합니다             
조금은 다른 속성을 가지고 있죠 이것들은 세로 윤곽선 검출을 위한 것이고             
90 도 회전하게 되면 가로 윤곽선 검출이 됩니다                      

# 딥러닝으로 필터 만들기
![image](https://user-images.githubusercontent.com/50114210/71305103-19422d00-2412-11ea-8181-e646eef0f7dd.png)                              
딥러닝의 발전과 함께 우리가 알게된 것은             
어떤 복잡한 이미지에서 윤곽선을 검출하려고 할 때                
이 9 개의 숫자를 일일이 고를 필요가 없을 수 있다는 것입니다              
스스로 학습하게 두고 9 개의 숫자를 아예 변수로 설정한 다음              
역전달 형식으로 학습된 9개의 숫자가 6 x 6 이미지와 3x3 필터가              
합성곱을 했을 때 좋은 윤곽선 검출기의 역할을 하게 하는 것입니다             
이후의 영상에서는 이 9 개의 숫자를 변수로 둘 것입니다 그래서 역전파로 이 변수들을 학습시켜               
1 1 1 0 0 0 -1 -1 -1 혹은 소벨 필터나 Scharr 필터                             
혹은 자료의 통계를 바탕으로 수동으로 만든 필터보다 더 좋은 필터를 학습할 수도 있겠죠                
그리고 가로 세로 윤곽선 뿐만 아니라 43 도나 70 도 혹은 73 도 기울어진 윤곽선이나                       
원하는 어떤 형태의 윤곽선도 검출할 수 있을 것입니다                          
9 개의 숫자를 변수로 두고 데이터로부터 학습하게 함으로써 신경망이 윤곽선같은 하위 단계의                  
속성을 학습할 수 있게 되고 컴퓨터를 연구하는 사람들이 직접 짠 것보다                
더 강력한 방식으로 학습할 수 있게 됩니다                 
하지만 이런 계산 안에서도 항상 이 합성곱 연산이 역전달의 형식으로 학습된 3 x 3 필터를 이미지에 적용하고                
이 위치와 이 위치 등에 적용해서 가로나 세로 윤곽선을 나타내거나                    
또는 다른 각도의 윤곽선 혹은 또다른  어떤 필터를 검출할 수 있습니다                
그래서 이 9 개의 숫자를 변수로 가지는 개념은 컴퓨터 비전에서 매우 중요한 역할을 합니다                     

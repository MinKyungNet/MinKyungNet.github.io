---
layout: post
title: "지역 제안 알고리즘"
tags: [Region proposals]
categories: [Convolutional Neural Networks]
---

# 학습 목표
- 지역 제안에 대해서 알아본다.

# 핵심 키워드
- 지역 제안
- R-CNN
- 분할 알고리즘

# 학습 내용
- R-CNN 알고리즘은 CNN분류기를 실행하기 전에 몇개의 지역만 고른 후 실행하는 아디이어입니다. 지역을 고르는 방식은 분할 알고리즘입니다. 분할된 영역에 대한 경계상자를 만들고 분류기를 실행합니다. 하지만, 속도가 느리다는 문제가 있었습니다.
- Fast R-CNN 알고리즘은 R-CNN 알고리즘에서 합성곱 슬라이드 윈도 구현을 더한 것입니다. 분류 속도는 빨라졌으니 지역 제안을 하기 위한 클러스터링 단계가 여전히 느리다는 단점이 있습니다.
- Faster R-CNN 알고리즘은 지역 분할 알고리즘대신 합성곱 신경망을 사용해서 실행 시간을 조금더 빠르게 만들었습니다.

# 인트로
물체 검출 문헌을 살펴보면 지역 제안 아이디어가 많이 보입니다               
컴퓨터 비전에서 또한 아주 영향력 있는 아이디어입니다 이 영상을 선택적인 것으로 만든 이유는                
제가 지역 제안 알고리즘을 덜 자주 사용하기 때문입니다               
그렇더라도 이건 영향력 있는 것이고 여러분의 작업에 쓰일 수도 있습니다               

# 지역 제안
![image](https://user-images.githubusercontent.com/50114210/71547527-5bf0a000-29e4-11ea-8ed4-5344ac8925fa.png)                     
슬라이딩 윈도 아이디어를 다시 생각해보면 훈련된 분류기를 이러한 모든 윈도에 실행해서               
자동차, 보행자, 또는 오토바이가 있는지 검출기를 실행합니다               
알고리즘을 합성곱으로 실행할 수도 있지만               
알고리즘의 하나의 약점은 명확하게 물체가 없는 많은 지역들을 분류한다는 것입니다               
여기 아래의 직사각형은 검정색이 대부분입니다 여기에는 아무것도 없을 것이 분명합니다               
또한 알고리즘은 여기에서도 실행되고 있습니다 여기 또한 아무것도 없어 보입니다               
R-CNN이라고 불리는 알고리즘입니다                
지역과 합성곱 네트워크 또는 지역과 합성곱 신경망을 의미합니다               
이게 하는 일은 컴포넌트 분류기를 실행할 몇 개의 지역만을 고르는 것입니다               
슬라이딩 윈도를 모든 윈도에 전부 적용하지 않고          
몇 개의 윈도만 골라서 거기에만 컴포넌트 분류기를 실행합니다          
지역 제안을 실행하는 방식은 분할 알고리즘이라 불리는 것입니다          
오른쪽과 같은 결과를 도출합니다 어떤게 물체가 될 수 있는지 알아내기 위해서          
예를 들어 분할 알고리즘은 여기 이 영역을 찾아내고          
따라서 여러분은 이 경계 상자에 분류기를 적용하자고 생각할 것입니다          
여기 이 초록색도 하나의 영역으로 보이니까          
이 직사각형에도 무언가 있는지 분류기를 실행해 볼 것입니다          
이 경우에 만약 이 파란 영역에 분류기를 실행하면          
아마 보행자를 찾을 수 있을 것이고 하늘색 영역에 실행하면 자동차를 찾을 것입니다          
이 세부 내용은 분할 알고리즘이라 불리고 약 2000개의 영역을 찾아서          
2000개의 영역에 대한 경계 상자를 만들고           
그 2000개의 영역에 대해서만 분류기를 실행합니다          
이건 컴포넌트 분류기를 실행하는 것보다 훨씬 작은 숫자입니다          
이미지의 모든 위치에 대해 실행하는 것보다 말이죠          
그리고 이건 특별한 경우인데 만약 컴포넌트 분류기를          
사각형 모양 지역 뿐만 아니라 보행자를 찾기 위해서 세로로 길쭉한 영역이나          
또는 자동차를 찾기 위한 가로로 넓은 영역 같은 다양한 모양으로 실행할 수 있습니다          
이게 R-CNN 혹은 지역 CNN 아이디어입니다           

# R-CNN
![image](https://user-images.githubusercontent.com/50114210/71547536-762a7e00-29e4-11ea-9457-f6ad73ee2062.png)         
R-CNN 알고리즘은 아직 꽤 느리기 때문에             
이 알고리즘의 속도를 높이기 위한 작업들이 있습니다            
기본적인 R-CNN 알고리즘은 어떤 알고리즘을 통해 지역을 제안하고 그것을 분류합니다            
각각의 지역은 레이블을 반환합니다            
저기는 자동차, 저기는 보행자 저기는 오토바이 같은 식으로요             
또한 경계 상자를 반환합니다            
따라서 그 지역에 어떤 물체가 있다면 정확한 경계 상자를 얻을 수 있습니다            
R-CNN 알고리즘은 주어진 경계 상자를 그냥 신뢰하지 않습니다            
분할 알고리즘에서 주어진 블록들을 둘러싼 경계 상자보다            
더 정확한 경계 상자를 얻기 위해서             
R-CNN 또한 경계 상자인 bx, by, bh, bw를 반환합니다            
따라서 꽤 정확한 경계 상자를 얻을 수 있습니다            
R-CNN 알고리즘의 약점 중 하나는 꽤 느리다는 것입니다            
그래서 몇 년간 R-CNN 알고리즘에 대한 몇몇 개선점이 있었습니다            

# Fast R-CNN
![image](https://user-images.githubusercontent.com/50114210/71547540-82aed680-29e4-11ea-9c1a-93f339f92a6f.png)                   
Ross Girshick은 빠른 R-CNN 알고리즘을 제안했습니다          
기본적인 R-CNN 알고리즘에 합성곱 슬라이딩 윈도 구현을 더한 것입니다          
원래의 구현은 한 번에 하나의 지역을 분류합니다          
빠른 R-CNN 알고리즘은 합성곱 슬라이딩 윈도 구현을 사용합니다          
이건 이번 주의 네 번째 영상에서 본 아이디어와 거의 비슷합니다          
이건 R-CNN의 속도를 약간 향상시킵니다          
빠른 R-CNN 알고리즘의 문제점 중 하나는 지역 제안을 위한 클러스터링 단계가          
여전히 꽤나 느리다는 것입니다          

# Faster R-CNN
![image](https://user-images.githubusercontent.com/50114210/71547542-8b071180-29e4-11ea-83be-a2ca4809b4de.png)               
그래서 Shaoqing Ren, Kaiming He, Ross Girshick, Jian Sun은         
더 빠른 R-CNN 알고리즘을 제안했습니다         
이것은 지역과 영역들을 제안하는 데에 분할 알고리즘 대신 신경망을 사용해서         
빠른 R-CNN 알고리즘보다 조금 더 빠릅니다         

# 아웃트로
하지만 더 빠른 R-CNN 알고리즘은 아직 YOLO보다 약간 느립니다          
지역 제안 아이디어는 컴퓨터 비전 분야에서 꽤 영향력 있습니다          
아직까지 쓰이는 아이디어들이니 잘 알아두시기 바랍니다          
컴퓨터 비전 연구단체는 아니고 제 개인적인 견해입니다          
지역 제안은 흥미로운 아이디어지만 두 개의 단계를 거치지 않는 것          
즉 지역 제안과 그것을 분류하는 단계를 YOLO 알고리즘처럼 한 번에 하는 것이          
제게는 장기적으로 더 좋은 방향으로 보입니다          
하지만 컴퓨터 비전 분야 전체의 견해는 아니고 단지 제 개인적인 견해입니다          
그러니까 편하게 생각하세요          
하지만 R-CNN 아이디어는 다른 사람들도 많이 사용하기 때문에          
이것을 알고 있으면 다른 사람들의 알고리즘을 이해하기 더 쉬울 것입니다          

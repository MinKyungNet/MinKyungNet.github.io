---
layout: post
title: "물체 인식"
tags: [object detection, sliding window detection]
categories: [Convolutional Neural Networks]
---

# 학습 목표
- 물체 인식 알고리즘을 설계하는 방법중 슬라이딩 윈도 검출을 배운다.

# 핵심 키워드
- 물체 인식
- 슬라이딩 윈도 검출

# 학습 내용
- 슬라이딩 윈도 검출은 사진을 윈도 사이즈에 맞춰 나눈다음 매 윈도우로 잘려진 이미지를 입력값으로 모델을 통과해서 결과를 얻는 방법입니다.
- 한번의 윈도 크기로 끝내는 것이 아니라 여러 크기의 윈도를 사용하여 반복합니다.
- 이 방법의 단점은 많은 영역을 잘라내어, 이미지의 모든 곳을 한번씩 훑어야하기 때문에 아주 큰 계산 비용이 듭니다.
- 하지만 윈도 크기를 너무 작게하거나, 스트라이드를 늘리게 되면 성능 저하, 즉 정확하게 물체를 못잡아 낼수도 있습니다.

# 인트로
여러분은 물체 로컬리제이션과 특징점 검출에 대해서 이미 배웠습니다       
이제 물체 인식 알고리즘을 설계하는 것을 배워보도록 하겠습니다       
이번 강의에서는 합성곱 신경망을 어떻게 사용하는지 배울 것입니다       

# 훈련세트 구성
![image](https://user-images.githubusercontent.com/50114210/71539411-249bd800-297f-11ea-9188-eef7c39a73a3.png)                   
물체 인식을 구현하기 위해 슬라이딩 윈도 검출 알고리즘 사용해 보겠습니다          
여기서 자동차 인식 알고리즘을 만든다고 해보겠습니다          
여러분은 가장 먼저 레이블 훈련 세트를 만들어야 합니다          
x와 y가 있는데 자동차에 근접해서 잘려진 샘플을 사용하도록 하겠습니다          
이 이미지 x는 긍정 샘플인데요 모두 자동차입니다           
이것은 자동차가 아니죠 이것도 자동차가 아닙니다          
이 훈련 세트의 목적은 근접하도록 잘려진 이미지를 사용한다는 것인데요          
x가 거의 자동차만 나타낸다는 것을 의미합니다           
사진을 찍어서 자동차가 아닌 부분을 잘라내면           
이미지의 대부분이 자동차가 나타내는 부분이 됩니다          
이 레이블 훈련 세트를 이용해 합성곱 신경망을 훈련할 수 있습니다          
입력으로 이런식으로 근접하게 잘린 이미지를 사용하고          
합성곱 신경망의 결과로 y가 출력으로 나옵니다          
자동차인지 아닌지에 따라  0 또는 1의 값이 나오게 됩니다          
일단 이 합성곱 신경망을 훈련한 후에는           
이것을 슬라이딩 윈도 검출에 사용할 수 있습니다          
이러한 테스트 이미지가 있을 때 이것을 하는 방법은          
아래 보이는 것처럼 특정 윈도 크기를 선택하는 것으로 시작합니다          
그리고 합성곱 신경망에 이 작은 사각형 영역을 입력하는 겁니다          
작은 빨강색 사각형을 합성곱 신경망에 입력하면           
합성곱 신경망은 예측값을 계산해낼 것입니다 아마도 이 작은 빨강 영역에 대해서는           
작은 빨간 사각형 안에는 자동차를 포함하지 않는다고 나오겠죠          

# 윈도우 사용
![image](https://user-images.githubusercontent.com/50114210/71539420-4ac17800-297f-11ea-84bd-04c7bb41cabd.png)                   
슬라이딩 윈도 검출 알고리즘에서는 이제 여러분이 해야 할 것은          
두 번째 이미지를 입력하는 것입니다         
약간 옆으로 옮겨진 이 빨간 사각형 부분이 됩니다         
그리고 이것을 합성곱 신경망에 입력합니다         
이미지의 이 영역을 빨간 사각형에 넣어 합성곱 신경망으로 보냅니다         
다시 합성곱 신경망을 통과시키는 것이죠 이제 세 번째 이미지를 가지고 이것을 수행합니다         
그리고 계속해서 이것을 반복하는 것입니다         
이미지의 모든 위치를 슬라이드 할 때까지 말이죠         
이 예시에서는 꽤 큰 간격으로 움직이도록 하였는데요         
단지 애니메이션을 빠르게 움직이도록 한 것이지만         
여기서 이 크기의 영역들을  통해서 사용되는 기본적인 개념은         
수 많은 잘려진 이미지를 합성곱 신경망에 통과시키는 것이         
각 위치에 대해서 0 또는 1의 값으로 분류된 다는 것입니다         

# 더 큰 윈도우 사용 1
![image](https://user-images.githubusercontent.com/50114210/71539426-557c0d00-297f-11ea-90f0-48664c58865d.png)                
슬라이딩 윈도라고 불리는 이것을 한번 완료하고 난 후에는            
이것을 반복하게 되는데 이번에는 더 큰 윈도를 사용합니다            
약간 더 큰 영역을 사용해 계산을 수행합니다            
이 영역의 크기를 변경해서 합성공 신경망이 입력으로 넣어줍니다            
이것을 합성곱 신경망에 통과시키면 0 또는 1의 출력을 가지게 되겠죠            
그리고 이 윈도를 마찬가지로 약간씩 슬라이드해서            
마지막에 도달할 때 까지 전체 이미지에 대해서 수행합니다            

# 더 큰 윈도우 사용 2
![image](https://user-images.githubusercontent.com/50114210/71539429-5d3bb180-297f-11ea-9c4d-c731a668a33d.png)                
그리고 세 번째 반복에서 더 큰 윈도를 사용하는 것입니다        
이것을 수행한 결과로 이미지 어딘가에 자동차가 있다면        
그것에 해당되는 윈도가 있을 겁니다        
예를 들어 이 윈도를 합성곱 신경망에 통과시키면        
이 입력 영역에 대해서 합성곱 신경망은 1의 출력값을 가집니다        
결국 여기에 자동차가 있다고 인식한 것이 됩니다        

# 슬라이딩 윈도우
따라서 이 알고리즘을  슬라이딩 윈도 검출이라고 부릅니다        
이 사각형 상자 모양의 윈도를 사용해 이것을 전체 이미지에 대해         
슬라이드 시키고 모든 사각형 영역에 대해서         
자동차가 포함되는지 분류하는 것이기 때문이죠        

# 슬라이딩 윈도우의 단점
슬라이딩 윈도 검출에는 큰 단점이 존재합니다 바로 계산 비용인데요             
여러분은 이미지의  수 많은 영역을 모두 잘라내야 하고             
그리고 합성곱 신경망을 통해 이것들을 각각 계산해야 합니다             
매우 큰 슬라이드 간격을 사용한다면 합성곱 신경망을 통과시켜야 하는             
윈도의 수는 줄어들 것입니다             
하지만 이렇게 띄엄띄엄하게 한다면 성능을 저하시킬 수 있습니다             
매우 정밀한 입도 또는 매우 정밀한 이동 간격을 사용한다면             
모든 작은 영역을 합성곱 신경망에 통과시켜야 하기 때문에             
매우 높은 계산 비용이 필요하게 되겠죠             
신경망이 성공적으로 사용되기 이전에는 사람들은 간단한 선형 분류기와 같은             
훨씬 간단한 분류기를 사용했는데 물체 인식을 수행하기 위해서             
직접 특징을 설정해주었습니다             
따라서 분류기가 선형 함수를 사용하기 때문에 계산 비용이 저렴했습니다             
여기서 슬라이딩 윈도 검출도 좋은 방법입니다             
나쁜 방법은 아니지만 합성곱 신경망을 이용하기 때문에             
단일 분류 작업을 수행할 때는 훨씬 비용이 비싸집니다             
또한 이런 슬라이딩 윈도를 사용하면 실행 불가능할 정도로 느려집니다             
하지만 매우 작은 입도나 작은 이동 간격을 사용하지 않는다면             
이미지에서 물체의 위치를 정확하게 알아낼 수 없을 겁니다             
운이 좋게도 이 계산 비용의 문제는             
좋은 해결 방법이 하나 있습니다 슬라이딩 윈도 물체 인식기를             
합성곱을 사용해 훨씬 효율적으로 구현할 수 있습니다             

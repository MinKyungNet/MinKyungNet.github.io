---
layout: post
title: "기울기의 수치 근사"
tags: [Gradient Checking]
categoires: [Improving deep neural networks]
---

# 학습 목표
경사 검사를 위한 미분계산 하는 방법을 배운다

# 핵심 키워드
경사 검사(gradient checking)

# 학습 내용
* 경사 검사를 하는 이유는 역전파를 알맞게 구현했는지 확인하기 위함입니다.
* 중심 차분법의 정의:
![image](https://user-images.githubusercontent.com/50114210/65296244-cea8de80-db9e-11e9-9a93-cb98cc745c1f.png)     
* 이 수치 미분은 중심 차분법보다 오차가 더 높습니다.

# 인트로
역전파를 구현할 때 경사 검사라는 테스트가 있습니다.   
역전파를 맞게 구현했는지 확인하는데 도움을 줍니다.    
모든 수식을 작성했더라고 세부사항이 맞게 작성됐는지 확신하지 못하기 때문에 경사 검사를합니다.   
이 글에서는 경사를 구현하기 위해 경사의 계산을 수치적으로 근사하는 방법을 알아보고,    
다음 글에서는 경사 검사를 구현해 역전파의 구현이 맞는지 확인하는 방법을 다루겠습니다.   

# 좀 더 넓은 곳에서 변화량을 계산    
![image](https://user-images.githubusercontent.com/50114210/65296987-542d8e00-dba1-11e9-95ab-1bbb659fdbf1.png)     
먼저 함수 f를 취해서 f(x) = x^3그래프를 나타내봅시다.   
x가 1인 경우에 1+입실론 값을 얻기 위해 x를 오른쪽으로 살짝 이동시킬 수도 있지만,    
왼쪽과 오른쪽 모두를 조금씩 움직여서 1-입실론, 1+입실론 값을 구해봅시다.    
편의상 0.99, 1.01이라고 하겠습니다.   
오른쪽으로 조금 움직인 값으로만 경사를 고려하는 대신    
양쪽으로 움직여 원래 지점을 줌심에 두어 더 나은 경사 비율을 알 수 있습니다.    
즉, 더 큰 삼각형에서 x대비 y의 변화량을 계산합니다.    

# 너비 동안의 변화량
![image](https://user-images.githubusercontent.com/50114210/65297035-7b845b00-dba1-11e9-9326-abd94d816468.png)         
오른쪽의 y값은 f(x+입실론)일 것이고, 왼쪽의 y값은 f(x-입실론)일 것입니다.    
따라서 큰 초록색 삼각형의 높이는 f(x+입실론) - f(x-입실론)입니다.    
삼각형의 너비는 한 부분이 입실론 + 입실론으로 2입실론입니다.    
즉, 큰 삼각형의 너비 동안의 변화량은 큰 삼각형의 높이입니다.   
그리고 이 값은 f'(x)와 비슷해야합니다.    

# 양 쪽의 오차 계산 
![image](https://user-images.githubusercontent.com/50114210/65297064-9060ee80-dba1-11e9-9f0b-c7df5a5063c6.png)        
값을 대입하기 위해 f(x) = x^3을 이용하면 ((1.01)^3 - (0.99)^3) / (1.01 - 0.99)입니다.   
계산해보면 3.0001의 값을 얻게 됩니다. f'(x) = 3x^2인것을 생각해보면,    
f'(1) = 3의 값과 매우 가깝습니다. 근사 오차는 0.0001입니다.    
한 쪽의 오차만 사용하여 계산한다면, ((1.01)^3 - 1^3) / (1.01 - 1) = 3.0301입니다.         
이때의 근사 오차는 0.03입니다. 0.0001보다 큰 값이죠.   
따라서 도함수를 근사하기 위해 양 쪽의 차이를 이용하는 방법을 사용하면           
원래의 값에 가까운 값이 나온다는 것을 알 수 있습니다.        
이것을 역전파의 경사 검사에서 사용한다면 한쪽의 차이만을 사용하는 것보다 두 배정도 느릴테지만,      
이 방법은 다른 방법에 비해 훨씬 정확하기때문에 가치가 있습니다.         

# 추가적인 이론
도함수의 공식적인 정의는 이렇습니다.    
![image](https://user-images.githubusercontent.com/50114210/65297092-ae2e5380-dba1-11e9-864a-3523f4b913ef.png)      
입실론이 0으로 갈 때의 극한값입니다.    
입실론이 0이 아닌 값에서 이 근사의 오차는 O(e^2)입니다. 입실론이 0.01인 경우 e^2은 0.0001이 됩니다.   
![image](https://user-images.githubusercontent.com/50114210/65297124-c43c1400-dba1-11e9-9df9-11692fd8c495.png)       
반면에 이 식을 사용하면 오차는 O(e)입니다. e이 1보다 작은 값이므로 e^2보다는 훨씬 큰 값입니다.       
즉 이 식은 왼쪽에 있는 식보다 훨씬 덜 정확한 근사입니다.   
따라서 경사 검사를 할 때 양 쪽의 차이를 사용하는 것이 한 쪽 차이를 사용하는 것보다 더 정확합니다.

# 아웃트로
양쪽의 차이를 취해서 수치적으로 함수 f'(x)가 함수 f(x)의 올바른 도함수를 구현하고 있는지 알아볼 수 있었습니다.    





---
layout: post
title: "훈련 개발 세트"
tags: [training-dev set]
categories: [Structuring Machine Learning Projects]
---

# 학습 목표
훈련-개발 세트에 대해 공부한다.

# 핵심 키워드
훈련 개발 세트

# 학습 내용
* 훈련 세트의 분포와 개발 세트의 분포의 차이 때문에 오차가 커진 것인지 아니면 일반화가 부족해서 생긴 분산 문제인지 구별하기가 어렵습니다. 훈련-개발 세트는 훈련 세트 중 일부를 떼어내서 전자의 문제를 알아보기 위한 도구입니다.
* 따라서 훈련-개발 세트의 오차가 훈련 세트와 크게 차이가 없다면, 분산 문제라고 볼 수 있습니다. 그러나 훈련-개발 세트와 개발 세트의 오차 차이가 크다면, 데이터 분포의 차이 문제입니다.
* 각각의 데이터 세트에 대해 어떤 문제가 있는지 아래의 그림을 참고하시길 바랍니다.
![image](https://user-images.githubusercontent.com/50114210/68987696-4594e780-086f-11ea-86ed-809d8e5120e1.png)

# 인트로
학습 알고리즘에서 편향과 분산을 예측하는 것은 해야 할 일의 순서를 정하는데 도움이 됩니다.           
편향과 분산을 분석하는 방법은 훈련 세트가 개발 세트와 다른 분포로부터 나올 때 달라지는데요.          
그것을 어떻게 하는지 보도록 하겠습니다.       

# 고양이 분류 예시, 훈련, 개발 세트의 분포가 같은 경우
![image](https://user-images.githubusercontent.com/50114210/68987964-25ffbe00-0873-11ea-87cd-b7afad0fbb01.png)          
여기에서도 고양이 분류 예시를 사용하겠습니다. 인간은 여기서 거의 완벽하게 구분 가능합니다.        
따라서 베이즈 오차는 거의 0퍼센트에 가까울 것입니다.       
이 오차를 분석하기 위해서는 일반적으로 훈련 오차와 개발 세트의 오차를 보게 됩니다.        
이 예시에서 훈련 오차는 1%라고 하고 개발 세트 오차는 10%라고 하겠습니다.          
만약 개발 세트의 데이터가 훈련 세트와 동일한 분포로 나온 것이라고 한다면         
여기엔 분산에 대한 문제가 있다고 할 수 있을 겁니다.         
그리고 이것은 알고리즘이 일반화될 수 없도록 만들죠.           
훈련 세트에서는 잘 작동하고 있지만 개발 세트에서는 좋지 않은 결과를 보여주기 때문입니다.        

# 훈련, 개발 세트의 분포가 다른 경우
하지만 훈련 데이터와 개발 데이터가 다른 분포로부터 나오는 상황에서는 같은 결론을 적용할 수는 없을 겁니다.         
개발 세트에서는 특히 문제가 없을 겁니다.        
이것이 훈련 세트가 매우 쉬운 경우이기 때문인데 고해상도의 깨끗한 이미지를 사용한 경우일 겁니다.          
그리고 개발 세트가 더 어려운 경우일 수도 있습니다 .          
따라서 이것이 분산의 문제가 아닐 수도 있다는 것입니다.           
개발 세트에 포함된 이미지들이 정확하게 분류하기 어려울 수도 있기 때문입니다.            

# 훈련, 개발 세트의 분포가 다른 경우에 분석이 어려운 이유
이 분석이 가지는 문제점은 훈련 세트에서 개발 세트로 가면서 두 부분이 바뀐다는 것입니다.         
첫 번째는 알고리즘이 개발 세트가 아닌 훈련 세트의 데이터만 본다는 것이고          
두 번째는 개발 세트 데이터의 분포가 다르다는 것입니다.       
두 가지가 동시에 바뀌기 때문에 여기서 9%의 오차 증가를 구별 해내기는 어렵습니다.         
어느 정도가 이 알고리즘이 개발 세트의 데이터를 보지 않기 때문인지           
따라서 이것이 분산의 문제인 것인지 또는 어느 정도가 단지 개발 세트의 데이터가 달라서인지 말이죠.            

# 개발 세트의 데이터 분포가 달라진 것인지 확인하기 위한 방법
![image](https://user-images.githubusercontent.com/50114210/68987981-8a228200-0873-11ea-91e6-97626199ecf8.png)          
이 두 가지 영향을 구분하기 위해서 유용하게 쓰일 새로운 데이터를 정의할텐데요.          
훈련-개발 세트라고 부르도록 하겠습니다.         
데이터들의 새로운 부분 집합이라고 할 수 있는데          
이것은 훈련 세트와 같은 분포를 가지지만 신경망의 학습에는 사용하지 않은 것들 입니다.             
이전엔 이런식으로 훈련 세트를 지정하고 개발 세트를 지정하고 테스트 세트를 지정했습니다.         
개발 세트와 테스트 세트는 같은 분포를 가지지만 훈련 세트는 약간 다른 분포를 가지게 되죠.      

# 훈련-개발 세트
![image](https://user-images.githubusercontent.com/50114210/68987990-ac1c0480-0873-11ea-83d9-872529aff58e.png)          
여기서 우리는 훈련 세트를 무작위로 섞은 후에 훈련 세트의 일부분을 분리할 것 입니다.       
그리고 이것을 훈련-개발 세트로 지정하는 것이죠.           
개발 세트와 테스트 세트가 동일한 분포를 가지는 것처럼 훈련 세트와 훈련-개발 세트도 마찬가지로 동일한 분포를 가집니다.       
차이점은 신경망을 훈련시킬 때 훈련 세트에서만 훈련 시킨다는 것입니다.           
이 데이터의 훈련-개발 세트에서는 역전파를 수행하지 않는 것이죠.         

# 분산 문제
![image](https://user-images.githubusercontent.com/50114210/68988016-1e8ce480-0874-11ea-81dd-ae2854f0e52e.png)           
이제 오차 분석을 위해서 훈련 세트와 훈련-개발 세트, 그리고 개발 세트까지 들여다 봐야 합니다.         
이 예시에서 훈련 세트의 오차는 1%, 훈련-개발 세트의 오차는 9%라고 하겠습니다.      
그리고 개발 세트의 오차는 10%라고 하겠습니다. 이전과 동일합니다.     
이것으로 부터 알 수 있는 것은 훈련 데이터에서 훈련-개발 데이터로 옮겨 갈 때 오차가 굉장히 크게 증가한 다는 것이죠.          
훈련 데이터와 훈련-개발 데이터의 차이점은 신경망이 이 훈련 세트만 본다는 것입니다.            
훈련 세트를 이용해 훈련하지만 훈련-개발 데이터로는 훈련하지 않기 때문입니다.         
따라서 이것은 분산의 문제가 있다는 것을 말해주는 것이죠.          
그 이유는 훈련-개발 세트의 오차가 훈련 세트와 동일한 분포를 가지는 데이터이기 때문입니다.         
따라서 신경망이 훈련 세트에서는 좋은 결과를 보이지만 같은 분포의 훈련 개발 세트에서는 일반화 되진 않았다는 것이죠.          
같은 분포를 가지더라도 일반화 되지 못한 것입니다. 이전에 보지 못했던 데이터였기 때문이죠.          
따라서 이 예시에서는 분산 문제가 존재합니다.          

# 데이터 불일치 문제
![image](https://user-images.githubusercontent.com/50114210/68988031-788daa00-0874-11ea-956c-64b8a73f21be.png)            
다른 예시를 보도록 하겠습니다 훈련 세트에서는 오차가 1%이고 훈련 개발 오차는 1.5%입니다.         
그리고 개발 세트에서는 10%의 오차를 가집니다. 여기서는 분산의 문제가 적다고 할 수 있죠.       
이미 봤던 훈련 세트에서 이전에 보지 못한 새로운 훈련 개발 세트로 왔지만       
오차는 조금밖에 상승하지 않았기 때문입니다. 하지만 개발 세트로 옮겨갈 때 오차가 크게 증가합니다.      
따라서 이것은 데이터 불일치가 문제인 것이죠. 데이터 불일치라고 적도록 하겠습니다.           
데이터 불일치 문제라고 하는 것이죠.        
학습 알고리즘이 개발 세트나 훈련-개발 세트에서 학습하지 않지만 이 두 데이터 세트는 다른 분포를 가집니다.           
알고리즘이 무엇을 학습하든지 훈련-개발 세트에서는 잘 작동하지만 개발 세트에서는 그렇지 않을 것입니다.          
따라서 알고리즘이 다른 분포에 대해서도 잘 작동하도록 해야 하는 것이죠.        
이것을 데이터 불일치 문제라고 부릅니다.         

# 편향 문제
![image](https://user-images.githubusercontent.com/50114210/68988037-af63c000-0874-11ea-8759-1f83ba79abdf.png)       
몇 개의 예시를 더 보도록 하겠습니다. 훈련 오차와 훈련-개발 오차, 그리고 개발 오차입니다.       
훈련 세트의 오차는 10% 훈련 개발세트의 오차는 11%이고 개발 세트의 오차는 12%입니다.          
인간 수준의 베이지안 오차는 0%에 가깝습니다.         
이런 형태의 결과가 나오는 경우는 편향 문제 또는 회피 가능한 편향 문제의 경우입니다.       
인간 수준에서보다 좋지 않은 결과가 나왔기 때문에 편향의 정도가 크다는 것입니다.          

# 편향 문제와 데이터 불일치 문제
![image](https://user-images.githubusercontent.com/50114210/68988056-eb972080-0874-11ea-8f7a-5626be801539.png)         
마지막 예시에서는 훈련 세트 오차가 10%, 훈련-개발 세트 오차는 11%, 개발 세트 오차는 20%입니다.          
여기엔 두 가지 문제가 존재하는 것을 볼 수 있습니다.         
첫 번째는 회피 가능한 편향이 꽤 높다는 것인데 이것은 훈련 세트의 결과가 좋지 않기 때문입니다.        
인간 수준에서의 오차는 0%에 가깝지만 훈련 세트는 10%의 오차가 나옵니다.       
그리고 이 부분의 분산은 작아 보이지만 이 부분에서  데이터 불일치는 꽤 크게 나타납니다.      
따라서 이 예시에서는 편향 또는 회피 가능한 편향 문제와 데이터 불일치 문제를 모두 가진다고 할 수 있습니다.         

# 다양한 문제를 가진 
![image](https://user-images.githubusercontent.com/50114210/68988075-1a14fb80-0875-11ea-961f-22b22568675c.png)           
여기서 눈여겨 볼 요소들은 인간 수준의 오차와 훈련 오차, 그리고 개발-훈련 세트의 오차입니다.           
이것은 훈련 세트와 동일한 분포를 가지지만 이것에 대해서 훈련하지는 않습니다. 그리고 개발 세트의 오차가 있습니다.            
이 오차의 차이값에 따라서 회피  가능한 편향 문제와 분산 문제, 데이터 불일치 문제가 어느 정도인지 가늠할 수 있습니다.             
인간 수준의 오차가 4%, 훈련 세트 오차가 7%라고 해봅시다.      
그리고 훈련-개발 세트의 오차는 10%, 개발 세트 오차는 12%라고 하겠습니다.        
이 부분은 회피 가능한 편향 문제에 대한 것을 알려줍니다.         
이것은 우리가 알고리즘이 최대한 쉬우면서도 훈련 세트에서도 인간 수준에 가까운 성능을 가지는 것을 원하기 때문이죠.         
이 부분은 분산의 문제인데 훈련 세트에서 훈련-개발 세트로 얼마나 잘 일반화하는지에 달려있죠.          
이 부분은 데이터 불일치의 문제입니다 그리고 여기에 테스트 세트의 결과까지 추가해 볼 수 있습니다. 테스트 오차라고 적겠습니다.          
테스트 세트에서는 개발을 하지 않아야 하는데 테스트 세트가 과대 적합 상태가 될 수 있기 때문입니다.          
이제 여기의 차이를 보시면 이것은 개발 세트에 대한 과대 적합 정도를 의미합니다.         
개발 세트와 테스트 세트의 성능이 큰 차이를 보인다면 이것이 개발 세트에 대해 과잉 조정되었다는 것을 뜻합니다.         
따라서 더 큰 개발 세트를 찾아야 할 것입니다.          
기억하고 계시듯이 개발 세트와 테스트 세트는 동일한 분포를 가집니다.           
따라서 이 부분이 더 큰 차이를 가지게 하는 방법은 개발 세트와 테스트 세트가                
좋은 결과를 가질 수 있도록 개발 세트에 대한 과대 적합을 잘 조절하는 것입니다.             
이 경우에는 개발 세트로 돌아가서 더 많은 데이터를 얻어야 하겠죠.          
여기서 제가 적은 이 숫자들은 아래로 내려갈수록 커지고 있죠. 하지만 증가하지 않는 경우도 있습니다.            

# 테스트 결과가 더 좋은 
![image](https://user-images.githubusercontent.com/50114210/68988090-724bfd80-0875-11ea-8f70-3a37d0d8248e.png)        
인간 수준에서는 오차가 4%, 훈련 세트 오차는 7% 훈련-개발 세트 오차는 10%라고 하고        
개발 세트의 오차를 보면 여기서는 놀랍게도 더 나은 결과가 나올 수 있습니다.            
6%가 되고 이 부분도 마찬가지로 6%가 되죠.       
예를 들어 음성 인식의 경우 이런 결과가 나오기도 하는데 훈련 데이터가 개발 세트와 테스트 세트보다 훨씬 어려운 경우입니다.            
여기서 이 두 값은 훈련 세트에 대해 계산되었고 이 두 값은 개발 테스트 세트로부터 계산된 것입니다.           
가끔 개발 테스트 세트의 분포가 더 쉬운 경우도 있는 것이죠.         
응용 프로그램에 따라서 이 결과가 더 낮아질 수 있습니다.       
이렇게 흥미로운 결과를 보고 나면 아마 이 분석에 대해서 더 일반화된 표현이 유용할 것입니다.         

# 백미러 예시
![image](https://user-images.githubusercontent.com/50114210/68988156-8d6b3d00-0876-11ea-994a-e9bf51b05a1c.png)      
이것을 음성 인식 백미러 예시로 설명하도록 하겠습니다 우리가 적었던 숫자들을 이 표에 나타내 보겠습니다.         
가로축에는 여러 가지 데이터 세트를 표시합니다. 예를 들어 일반적인 음성 인식 데이터가 있습니다.         
많은 데이터가 존재할 것인데요 많은 양의 음성 인식을 통해서 수집된 데이터입니다.          
스마트 스피커의 데이터 또는 직접 구매한 데이터 등이 있습니다. 그리고 백미러가 있습니다.         
차 안에서만 녹음된 음성 데이터들이죠. 이 표의 x축에는 여러 데이터 세트를 표시했습니다.         
다른 축에는 데이터를 계산하는 여러 알고리즘을 표시하겠습니다. 가장 먼저 인간 수준의 성능이 있습니다.         
인간이 각 데이터 세트에 대해 얼마나 정확하게 판단하는지를 뜻합니다.          
그 다음은 신경망이 훈련된 데이터에서 나타내는 오차입니다.         
마지막은 아직 훈련되지 않은 데이터에서의 오차입니다.       
이전 슬라이드에서 인간 수준에 대해서 이야기 했던 것을 보면       
이 부분에 들어가는 숫자는 인간이 얼마나 잘 구분할 수 있는지에 대한 것입니다.          
이 분류를 가지는 음성 인식 데이터에 대해서 말이죠.         
훈련 세트를 위한 5000가지의 다양한 음성이 있었죠. 이전 슬라이드의 예시에서는 이 값이 4%였습니다.      
이 부분에 들어갈 숫자는 훈련 세트 오차가 될 것입니다. 이전 슬라이드에서는 7%였습니다.      
이것은 이 학습 알고리즘이 이 샘플들을 학습하거나 이 샘플을 이용해 경사 하강법을 수행했다면              
이 예시들이 훈련 세트로부터 나온 분포를 가지거나 일반적인 음성 인식과 같은 분포를 가질 때       
이 훈련된 알고리즘이 이 샘플에 얼마나 잘 작동하는지를 의미합니다.      
여기에는 훈련-개발 세트의 오차가 오게 됩니다. 약간 더 높은 값을 가지는데요.          
일반적 음성 인식에서 이 분포를 가지는 데이터에 대한 값입니다.          
알고리즘이 이 데이터 샘플에 대해 훈련되어 있지 않을 때 얼마나 잘 작동하는지를 의미하는 것입니다.     
우리가 훈련-개발 오차라고 부른 것이죠. 이제 오른쪽 부분을 보도록 하겠습니다.            
이 부분은 개발 세트 오차에 해당됩니다. 또는 테스트 세트 오차라고 할 수도 있습니다.          
우리가 사용했던 예시에서는 6%였죠.  사실 개발 오차와 테스트 오차는 다른 값이어야 합니다.           
어쨌든 둘 중 하나가 이 부분에 들어가면 됩니다.         
백미러 응용프로그램에 차 안에서 녹음된 데이터가 있더라도 신경망은 이 샘플 데이터를 가지고 역전파를 수행하지는 않습니다.         
이전 슬라이드에서 했던 것은 여기 두 숫자의 차이를 확인하고          
여기 두 숫자, 그리고 여기 두 숫자의 차이를 확인하는 것이었습니다.         
이 부분의 차이는 회피 가능한 편향 문제를 나타내고 이 부분은 분산의 문제의 정도,      
그리고 이 부분의 차이는 데이터 불일치의 정도를 나타냅니다.         
이제 나머지 두 부분까지 채워져야 이것을 유용하게 사용할 수 있을텐데요. 이 부분은 6%가 될 것입니다.     
이 값은 인간에게 백미러 음성 인식 데이터를 구분하게 했을 때의 얼마나 인간이 잘 해내는지를 나타내는 것입니다.       
이 부분도 마찬가지로 6%가 됩니다.          
그 이유는 백미러의 음성 데이터가 훈련 세트에 포함되기 때문에      
신경망이 이것에 대해서도 학습할 수 있기 때문입니다. 그 데이터의 부분 집합에 대해서 오차를 측정하게 되는 것이죠.         
이 값을 얻게 되면 이것은 인간 수준의 결과를 얻는 것과 같습니다. 이 백미러 음성 데이터에 대해서 말이죠.     
따라서 이 분포의 데이터에 대해서 상당히 좋은 결과가 나오는 것입니다.         
     

# 표의 깊은 분석
이것에 대해서 더 깊이 분석을 한다면 항상 깔끔하고 정확한 결과가 나오진 않겠지만     
가끔은 추가적인 정보를 얻을 수도 있을 겁니다.         
예를 들어서 이 두 값을 비교하는 것을 통해 인간에게는 백미러 음성 데이터가       
일반적 음성 인식 데이터에 비해 어렵다는 것을 알 수 있죠.         
여기서 4%보다 큰 6%의 오차가 생기기 때문입니다.          
마찬가지로 이 부분의 차이를 보게 되면 편향, 분산, 데이터 불일치 문제에 대해 이해할 수 있습니다.          
이 더 일반적인 표현이 제가 사용했던 것들이었습니다.         
직접 사용한 적은 없지만 이 부분을 계산해야 하는 많은 문제들에 대해서
여기의 차이, 이 부분의 차이 그리고 이 부분의 차이를 보면 꽤 좋은 방향을 알아내는데 충분히 도움이 될 것입니다.           
가끔은 전체 표를 모두 채우는 것이 추가적인 정보를 줄 수도 있습니다.        

#  데이터 불일치 문제의 
지금까지 편향과 분산을 설명하는 것에 대해 이야기 했습니다.          
그렇다면 데이터 불일치 문제는 어떻게 설명해야 할까요?          
개발/테스트 세트와 다른 분포의 데이터로 훈련하는 것은     
훈련에 더 많은 데이터를 사용할 수 있어서 알고리즘의 성능에 도움이 되죠.        
하지만 편향과 분산 문제와 다르게 이것은 데이터 불일치에 대한 새로운 잠재적 문제를 가집니다.     
이 데이터 불일치를 잘 해결하는 방법은 무엇일까요?            
이것이 엄청 거창하거나 체계적인 방법을 필요로 하는 것은 아닙니다.         
하지만 도움이 될 만한 것을 시도해 볼 수 있겠죠.         

# 아웃트로
지금까지 우리가 공부한 것을 말씀드리자면      
다른 분포의 훈련 데이터를 개발/테스트 세트로 사용했는데         
이것은 더 많은 데이터를 제공하고 학습 알고리즘의 성능에 도움을 주게 되죠.           
편향과 분산 문제가 잠재적 문제가 되기도 하지만        
세 번째로 데이터 불일치 문제도 잠재적 문제가 된다는 것을 보았습니다.     
따라서 어떻게 오차 분석을 진행해야 데이터 불일치 문제가 오차의           
큰 원인임을 결론 지을 수 있을까요? 어떻게 이것을 해결하는 것이 좋을까요?        
불행하게도 데이터 불일치를 해결하는데 아주 체계적인 방법은 없습니다.      
하지만 시도해 볼 수 있는 몇 가지 방법이 존재하죠.           

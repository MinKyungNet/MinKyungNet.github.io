---
layout: post
title: "End to End Deep Learning 사용여부"
tags: [end to end 딥러닝]
categories: [Structuring Machine Learning Projects]
---

# 학습 목표
언제 end to end 딥러닝을 사용할지 공부한다.

# 핵심 키워드
end to end 딥러닝

# 학습 내용
* end to end 딥러닝의 장단점
* 장점
  - 데이터로 하여금 말을 하게 합니다. 즉, 사람의 선입견 영향을 덜 받습니다.
  - 사람의 중간 요소 설계를 줄일 수 있습니다.
* 단점
  - 방대한 양의 데이터가 필요합니다.
  - 잠재적으로 유용하고 사람의 손으로 만들어진 중간 요소를 완전 배제합니다. 이는 데이터가 적을 때 효율적인 특정 지식을 사용할 수 없습니다.
* 따라서, end to end 딥러닝을 사용하기 전에 항상 어떤 작업을 하려고 하는지, 특히, 지도학습에서 x, y를 어떻게 연관지을 것인지를 생각해야합니다.
* 또한, 학습하기 위한 데이터가 충분한지도 고려해야합니다.

# 인트로
지금 머신 러닝 시스템을 구축하려 한다고 해봅시다.          
그리고 end-to-end 방식을 사용할지 말지 고민 중이죠. end-to-end 딥러닝의 장단점을 한 번 알아봅시다.                     
그래서 이것이 일종의 가이드라인이 되어서 end-to-end 방식이 유용할지 그렇지 않을지 판단할 수 있게 말이죠.          

# end to end 학습의 장점1, 선입견에 영향을 받지 않는다.
![image](https://user-images.githubusercontent.com/50114210/69197065-b3912580-0b73-11ea-9631-faaa38d08367.png)          
여기 end-to-end 학습의 몇 가지 장점들이 있습니다. 첫째로는 end-to-end 학습은 데이터가 직접 나타내게 해줍니다.            
그래서 충분한 양의 (x, y) 형태의 정보가 있다면 x 를 y 로 이어주는 가장 적절한 함수가 어떤 것이던            
충분한 크기의 신경망을 훈련시킨 뒤 그 신경망을 통해 알아낼 수 있죠.          
순수한 머신러닝 학습법을 가지게 됨으로써 x 나 y 로부터 학습하는 신경망이           
**사람의 선입견에 영향 받지 않고 데이터 그 자체를 학습**하게 됩니다.             
음성 인식의 경우에는 이전의 방식에서는 소리의 기본 단위인 음소의 개념이 있었습니다.          
이전의 방식에서는 소리의 기본 단위인 음소의 개념이 있었습니다.          
제 생각에는 음소란 언어학자들이 만들어낸 인위적인 것입니다.           
음소는 언어를 설명할만한 그럴듯한 환상에 가깝죠.         
그래서 특정 알고리즘이 음소의 개념을 취해야 할 필요는 없습니다.          
만약 알고리즘이 원하는 표현법을 알아서 학습하게 하고 음소의 개념을 굳이 사용하지 않는다면         
전체적인 성능은 더욱 향상하게 될 것입니다.         

# end to end 학습의 장점2, 중간 요소 설계를 적게해도 된다.
![image](https://user-images.githubusercontent.com/50114210/69197090-c572c880-0b73-11ea-92a4-1ca9b0f1f3fa.png)           
end-to-end 딥러닝의 두 번째 장점은 중간 요소 설계를 적게 해도 된다는 것입니다.      
이것으로 작업을 많이 단순화할 수 있게 되죠.           
데이터 특징이나 중간 요소들을 직접 설계하는데 시간을 쏟지 않아도 되기 때문입니다.          

# end to end 학습의 단점1, 많은 양의 자료가 필요하다.
![image](https://user-images.githubusercontent.com/50114210/69197098-cf94c700-0b73-11ea-8d44-e073a762dfde.png)             
그렇다면 단점은 어떤 것이 있을까요. 첫 번째로는 많은 양의 자료가 필요하다는 것입니다.          
x 가 y 를 한 번에 가리키기 위해서는 아주 많은 양의 (x, y) 형태의 정보가 필요하죠.       
이 전의 영상에서 각각의 단계에서 많은 정보가 필요한 것을 살펴봤었습니다.          
얼굴 인식처럼 이미지에서 얼굴을 찾는데에 많은 자료가 필요하고 그 얼굴을 인식하는 것도 마찬가지입니다.           
end-to-end 방식으로 처리하기에는 자료의 양이 부족하죠.          
여기서 x 는 end-to-end 의 입력 끝부분이 되고 y 는 출력의 끝부분이 될 겁니다.              
그래서 이 시스템을 위해서는 많은 x, y 값이 필요하게 되죠. 이것이 end-to-end 학습이라 불리는 이유입니다.          
왜냐하면 한 쪽 끝에서 시작해서 반대쪽 끝으로 바로 가는 학습법이기 때문이죠.           

# end to end 학습의 단점2
![image](https://user-images.githubusercontent.com/50114210/69197110-df141000-0b73-11ea-80f8-8580f1eb87c0.png)        
또다른 단점은 잠재적으로 유용하고 사람의 손으로 만들어진 중간 요소를 배제한다는 것입니다.         
머신러닝을 연구하는 사람들은 직접 만든 것들을 얕보지만 정보가 적을 경우에는            
이 알고리즘은 그 자료들로부터 영감을 얻지 못할 수 있습니다.          
인간에 의해 만들어진 중간 요소들은 알고리즘에 수동으로 특정 지식을 집어넣을 수 있습니다.        
절대로 안 좋은 것이 아니죠.        
학습 알고리즘에는 두 가지 정보원이 있는데 하나는 데이터고 다른 하나는 직접 설계한 요소입니다.         
중간 요소나 어떤 다른 특성들이 되겠죠.             
자료가 아주 많다면 이런 것들이 덜 중요하지만 자료가 많지 않다면 이렇게           
직접 설계한 시스템을 통해 알고리즘에 사람의 지식을 넣어 유용하게 쓸 수 있죠.          
그래서 end-to-end 딥러닝의 단점은 이렇게 유용하게 쓰일 것들을 배제한다는 것입니다.          
이런 직접 설계한 요소들은 아주 유용할 수도 있지만 만약 알고리듬에게 강제로 음소를 학습하도록 해서       
더 나은 표현이 있음에도 그것을 제한해 성능을 제한한다면 이것이 양날의 검이 될 수 있습니다.        
하지만 직접 설계한 요소들은 작은 훈련 세트에서는 도움이 되는 편입니다.         

# end to end 학습을 위해선 충분한 양의 데이터가 필요하다
![image](https://user-images.githubusercontent.com/50114210/69197313-58abfe00-0b74-11ea-91a3-72b721b9552a.png)            
그래서 만약 새로운 머신러닝 시스템을 구축하면서 end-to-end 딥러닝을 사용할지 말지를 결정할 때             
가장 중요한 것은 **x 를 y 로 연결 짓기에 충분한 함수를 학습할 수 있을 만큼의 자료를 가지고 있는가** 입니다.               
"충분한" 이라는 표현의 정의를 내리지는 못하지만 직감적으로 x 에서 y 로 가는 함수를 학습할 때          
이런 이미지를 보고 뼈의 위치를 인식하게 되겠죠.      
상대적으로 이미지에서 뼈를 인식하는 것은 간단한 문제고 그리 많은 자료를 필요로 하지 않습니다.            
또는 어떤 사람의 사진이 주어졌을 때 이미지에서 얼굴을 찾는 것은 그리 어려운 문제가 아닙니다.      
그래서 사람의 얼굴을 찾는데는 많은 자료가 필요하지는 않죠.         
혹은 문제를 해결할 수 있는 업데이트를 찾을 수 있을 겁니다.             
반면에 어떤 함수가 손을 보고 바로 아이의 나이를 알아내는건 훨씬 복잡한 문제입니다.         
순수한 end-to-end 학습법을 적용시키려면 더 많은 양의 정보를 학습해야겠죠.         

# 자율 주행 예제
![image](https://user-images.githubusercontent.com/50114210/69197383-84c77f00-0b74-11ea-9beb-5315d444f130.png)            
좀 더 복잡한 예시를 살펴보고 마무리합시다.           
저는 요즘 자율 주행 회사인 drive.ai 많이 돕고 있어서 자율 주행에 굉장히 관심이 많습니다.           
어떻게 스스로 운전하는 차를 만들 수 있을까요?          
end-to-end 학습법이 아닌 다른 방식 중 할 수 있는 것은 먼저 자동차 앞에 있는 것의 이미지를 입력 받습니다.         
레이더 같은 감지기를 사용하겠지만 편의를 위해서 자동차 앞과 주변의 사진을 입력 받는다고 해봅시다.        
차를 안전하게 운전하기 위해서는 다른 차와 보행자를 감지해야 합니다.          
물론 다른 것도 감지해야 하지만 간단한 예시로 살펴봅시다.          
다른 차들과 보행자의 위치를 감지한 뒤에는 경로를 계획해야 합니다.         
다시 말해서 다른 차들과 보행자들을 보고 어떻게 차를 조종할지 정하고           
자동차를 특정 경로로 운전하기로 결정했다면 이것을 도로를 위에서 본 장면이라 해봅시다.          
이 차가 당신의 차이고 이 경로로 운전하려 한다면 이것을 수행하기 위해서         
적절한 조종과 함께 가속과 제동 명령을 내려야 합니다.          
그래서 이미지나 감지기로 자동차나 보행자를 감지하는 것에는 딥러닝이 유용하지만           
다른 차들과 보행자들의 위치를 감지한 뒤 직접 경로를 설정해서 움직이는 것은 딥러닝이 아닌      
모션 플래닝이라는 소프트웨어를 사용합니다.        
어떤 경로로 차를 움직일지 결정한 후에는 또다른 알고리즘이 있습니다.         
제어 알고리즘이라고 부르게 될 이것은 정확한 결정을 내려서          
얼마만큼 운전대를 돌리고 악셀과 브레이크를 밟을지 결정하죠.               

# end to end 딥러닝을 언제 활용할지는 잘 
![image](https://user-images.githubusercontent.com/50114210/69197409-93ae3180-0b74-11ea-88d4-3a22febc9ae0.png)          
이 예시가 보여주는 것은 머신러닝이나 딥러닝을 이용해서 특정 요소를 학습하려 할 때
그리고 지도 학습에 적용할 때 x, y 를 어떻게 연관 지을지 어떤 작업을 위해 데이터를 얻을지 잘 정해야 합니다.          
이미지를 받은 뒤 순수한 end-to-end 방식을 사용하여서 조종하는 것이 꽤나 흥미롭습니다.          
하지만 자료의 가용성과 신경망의 학습 종류에 따르면 그리 효과적인 접근 방식은 아닙니다.         
또는 이것이 그 팀의 최선의 접근법이 아닌 것이죠.        
실제로 순수한 end-to-end 접근 방식은 이러한 복합적인 접근법보 효과적이지 못합니다.           
오늘 날까지 주어진 신경망을 훈련시킬 데이터만을 가지고는 말이죠.         
end-to-end 딥러닝은 어떤 상황에서는 효과적이지만 언제 end-to-end 딥러닝을 활용할지는 잘 고려해봐야 합니다.        

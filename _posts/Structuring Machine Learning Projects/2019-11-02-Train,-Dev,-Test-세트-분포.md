---
layout: post
title: "Train/Dev/Test 세트 분포"
tags: [Train set, Dev set, Test set]
categories: [Structuring Machine Learning Projects]
---

# 학습 목표
학습 세트, 개발 세트, 그리고 시험 세트를 설정하는 방법을 배운다.

# 핵심 키워드
* 훈련 세트(train set)
* 개발 세트(dev set)
* 시험 세트(test set)

# 학습 내용
* 개발 세트는 교차 검증 세트라고 불리기도 하며, 개발 세트를 통해 다양한 아이디어를 검증하고 선택합니다.
* 향후 현실에서 얻을 수 있고, 좋은 성과를 내는 중요한 데이터에 대해 개발 및 시험 세트를 설정합니다.
* 개발 세트와 시험 세트의 분포는 같아야합니다. 보통 데이터를 무작위로 섞은 뒤에 개발 세트와 시험 세트를 선택합니다.

# 인트로
학습 세트, 개발 세트, 그리고 시험 세트를 설정하는 방법은            
여러분 또는 여러분이 속한 팀의 머신러닝 어플리케이션을 만드는 데 큰 영향을 끼칩니다.         
아주 큰 회사의 팀을 살펴보더라도 이런 데이터 세트를 팀의 진도가 매우 느려지게끔 설정하는 경우도 있습니다.           
어떻게 팀의 효율성을 극대화하면서 데이터 세트를 설정하는지 살펴봅시다.         
이 영상에서는 개발 세트와 시험 세트를 설정하는 방법에 초점을 둘 겁니다.         
개발 세트는 development 세트라고도 불립니다. 교차 검증 세트라고도 불리고요.               
머신러닝에서 일의 흐름은 여러 아이디어를 시도해보고            
다양한 모델을 학습시키며 개발 세트를 이용해 각 아이디어를 평가한 뒤 하나를 고르는 겁니다.         
그리고 이 과정을 개발 세트 성능이 만족스러울 때까지 반복하고 시험 세트를 이용해 평가하죠.            

# train set과 dev set의 분포가 아예 다른 경우
![image](https://user-images.githubusercontent.com/50114210/68084740-39775600-fe7d-11e9-83b2-d7eda854fe1a.png)           
이제 여러분이 분류기를 만들고 있고 여러분이 이런 지역에서 작동시킨다고 합시다.       
미국, 영국, 기타 유럽 국가 남미, 인도, 중국, 기타 아시아 국가, 호주입니다.          
그러면 개발 세트와 시험 세트는 어떻게 설정해야 할까요?      
한 가지 방법은 네 개의 지역을 골라서요.          
저는 위쪽 네 개를 고를 거지만 무작위로 네 개를 고를 수도 있겠죠?         
이 네 개 지역의 데이터가 개발 세트로 사용되고요.         
역시 무작위로 선택될 수 있는 나머지 네 개 지역의 데이터들은 시험 세트로 사용되는 거죠.    
이건 굉장히 나쁜 방법입니다.        
왜냐하면 개발 세트와 시험 세트가 서로 다른 지역에서 만들어졌기 때문이죠.         
저는 대신 개발 세트와 시험 세트가 동일한 분포에서 만들어지기를 추천합니다.       

# train set과 dev set을 잘 설정해야 하는 이유
![image](https://user-images.githubusercontent.com/50114210/68084749-498f3580-fe7d-11e9-867f-ac7cdea42336.png)            
더 설명을 해보죠. 여러분이 마음에 두어야 하는 그림인데요.         
개발 세트와 하나의 실수 평가 척도를 정하는 것은 이것은 마치 목표를 정한 뒤        
여러분의 팀에게 과녁이 어디 있는지를 말하는 것과 같습니다.             
왜냐하면 개발 세트와 척도를 설정하고 나면 곧바로 팀은 개발 세트와 척도를 이용해         
과정을 빠르게 반복하며 여러 아이디어를 시도 및 실험합니다.          
그러면 분류기를 평가해서 최고를 하나 고를 수 있죠.           
즉 머신러닝 팀은 목표를 향하여 다른 종류의 화살을 여럿 던지는 걸 꽤 잘 합니다.          
과정을 반복하며 과녁을 명중시키는 데 점점 가까워지죠.          
즉 개발 세트에서 척도에 따르면 좋은 성능을 보이는 겁니다.         

# 랜덤하게 섞어서 정해라
![image](https://user-images.githubusercontent.com/50114210/68084756-56138e00-fe7d-11e9-8db3-0f8cd83b10d6.png)       
다시 왼쪽 예시에서 개발 세트와 시험 세트를 어떻게 설정하느냐의 문제로 돌아가보면        
만약 여러분의 팀이 개발 세트에서 혁신적인 성과를 내는 데 여러 달을 쏟았다면               
밑에 있는 네 개 지역의 데이터에서 얻은 시험 세트에 대하여          
마침내 시험을 할 때 그 데이터는 개발 세트의 데이터와 매우 다를 겁니다.         
그러고는 아주 깜짝 놀란 뒤 여러분이 개발 세트에 최적화하기 위해             
쏟아부은 수개월이 시험 세트에서는 좋은 성능을 못 낸다는 걸 깨닫게 되는 거죠.          
따라서 개발 세트와 시험 세트를 다른 분포에서 얻어오는 것은 과녁을 설정한 뒤               
팀이 과녁에 가까워지려 여러 달을 썼는데 그 시간이 지난 후에           
시험을 하기 위해서는 과녁을 이리로 옮겨야 한다는 걸 깨닫는 거죠.             
그래서 여러분이 갑자기 과녁을 다른 데로 옮기면
팀원들은 옮긴 과녁으로 최적화하는 데 시간을 쏟도록 말해주지 그랬어 라고 할 겁니다.           
이런 상황을 막기 위해서 추천하는 것은      
이 데이터를 무작위로 섞은 뒤에 개발 세트와 시험 세트를 얻는 겁니다.           
즉 개발 세트와 시험 세트 모두 여덟 개의 지역에서 얻어지는 것이죠.         
모든 실제 데이터가 섞여 있는 같은 분포에서 개발 세트와 시험 세트를 얻습니다.         

# 중산층의 상환여부를 train set으로
![image](https://user-images.githubusercontent.com/50114210/68084775-9bd05680-fe7d-11e9-831d-869670af84e2.png)      
여기 또다른 예시가 있는데요 약간의 변형이 가미된 실화입니다.                   
중산층의 우편 번호를 토대로 한 대출 승인으로 구성된 개발 세트에          
최적화하는 데 어떤 머신러닝 팀이 여러 달을 썼습니다.         
여기서 머신러닝 문제는 대출 신청에 관한 입력값 x에 대해서          
대출금을 상환할 수 있는지 여부인 y를 예측하는 것입니다.          
대출 승인 여부를 결정하는데 도움을 주는 것이죠.               
개발 세트는 중산층 우편번호에서 온 대출 신청을 바탕으로 했습니다. 미국에서의 우편번호죠.           

# 저소득층의 상환여부를 dev set으로    
![image](https://user-images.githubusercontent.com/50114210/68084781-b0145380-fe7d-11e9-812d-d2dc67ea7453.png)         
하지만 이 주제에 관해 몇 달을 연구한 팀은          
저소득층 우편 주소의 데이터를 토대로 시험을 하기로 결정합니다.           
당연히 중산층과 저소득층에서 얻어지는 데이터의 분포는 매우 다릅니다.          
하지만 분류기는 전자에 너무 최적화되어 있어서 후자의 경우에는 좋은 성과를 내지 못했습니다.         
즉 이 팀은 세 달 가까이를 낭비하고 처음으로 돌아가 일을 다시 시작했습니다.              
여기서 일어난 일은 팀이 어떤 목표를 두고 세 달을 썼지만                 
세 달 후에 매니저가 완전히 다른 위치의 다른 목표를 맞히는 건 어떠냐고 제안하자.       
팀이 아주 당황스러운 상황에 처하게 된 것이죠.          

# 가이드라인
![image](https://user-images.githubusercontent.com/50114210/68084800-f79adf80-fe7d-11e9-8b92-8df8243641c0.png)     
개발 세트와 시험 세트를 설정할 때 추천드리는 것은 미래에 얻어질 것으로 예상되고         
좋은 성과를 내는 것이 중요한 데이터에 대하여 개발 세트와 시험 세트를 고르라는 겁니다.           
특히, 개발 세트와 시험 세트는 동일한 분포에서 얻어져야 합니다.                
미래에 얻어질 것 같고 또 좋은 성과를 냈으면 하는 데이터가             
무슨 타입이든지 간에 그 데이터를 얻어서 개발 세트와 시험 세트 양쪽에 넣어야 합니다.         
그렇게 하면 여러분이 정말 맞히고 싶은 목표를 정할 수 있고              
여러분의 팀은 아주 효율적으로 과정을 반복할 수 있습니다. 동일한 과녁을 맞히기 위해서요.          
 
# 아웃트로
이 영상에서 중요한 것은 개발 세트와 평가 척도를 설정하는 것은          
여러분이 목표로 하는 과녁을 정의하는 것이고 개발 세트와 시험 세트를                
같은 분포에서 얻어서 여러분의 머신러닝 팀이 맞혔으면 하는 목표를 정말로 겨누게 된다는 사실입니다.                      
저는 이 영상의 가이드라인을 잘 따른다면 몇몇 머신러닝 팀이 수개월의 시간을                    
아낄 수 있으리라고 믿습니다. 여러분 역시 도움을 받을 수 있습니다.         

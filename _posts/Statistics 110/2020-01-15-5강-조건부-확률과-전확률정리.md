---
layout: post
title: "5강 조건부 확률과 전확률정리"
tags: [Law of Total Probability, prior, posterior probability, conditional independence]
categories: [Statistics 110]
---

# 학습 내용
### 문제 푸는 방법
- 간단한 케이스와 극단적인 케이스에 적용해보기        
- 문제를 작은 문제들로 쪼개서 생각해보기       
![image](https://user-images.githubusercontent.com/50114210/72448027-b453da00-37f9-11ea-970a-fc648656169d.png)

![image](https://user-images.githubusercontent.com/50114210/72448058-c33a8c80-37f9-11ea-8f4a-5a041bff8cd4.png)

![image](https://user-images.githubusercontent.com/50114210/72448106-d8afb680-37f9-11ea-929d-b3de6215ae0c.png)

![image](https://user-images.githubusercontent.com/50114210/72448147-e6653c00-37f9-11ea-9b4f-d3d683bf1f5c.png)

![image](https://user-images.githubusercontent.com/50114210/72448170-efeea400-37f9-11ea-9b6c-eb1c08d5bb39.png)

![image](https://user-images.githubusercontent.com/50114210/72448193-f846df00-37f9-11ea-8579-cc45e38ed2f6.png)


# 인트로
![image](https://user-images.githubusercontent.com/50114210/72442879-a8174f00-37f0-11ea-87c0-d1426194dce6.png)           

오늘은 확률에 그치는 것이 아닌 그 생각을 다뤄보자.          
확률을 불확실과 무작위를 다루는 방법이다.   
지난번의 정리는 간단했지만 어떻게 생각할지는 복잡하다.       
오늘은 그 예제를 보며 생각해보자.        
조건부로 생각하는 것이 이 과목에서 가장 큰 테마입니다.          
이는 조건부로 생각한다는 것이 어떠한 의미인지 이해하기 전까지는            
명확하게 생각하기 어렵다는 것을 뜻하기도 한다.          

### 일반적인 문제 풀이법          
문제를 해결하는 데에는 많은 방법들이 있습니다.      
1) 극단적이지만 간단한 상황을 시도해보기      
2) 문제를 더 작은 조각으로 나누기         
B의 확률을 아고 싶다면 쪼갠뒤에 겹친 부분들을 더해줘도 되겠지           
근데 겹친 부분이라는게 교집합이니까             
P(B)*P(B|A1)로 적을 수도 있겠지           
이를 n개의 조각에 적용해주면 이 식은 전체 확률의 법칙이라고 한다.           

###조건부 확률이 중요한 2가지 이유         
1. 그 자체로 중요하다.         
어떠한 단서가 있을 때 이 단서를 기반으로 확률을 갱신하는 것자체가 중요하지          
2. 비조건부 확률이 필요하더라도 작은 조각들로 쪼개기 위해서는 조건부 확률이 필요하기 때문

# 예제 1
임의의 2장의 카드가 있다고하자.      
52장의 카드중 2장을 뽑고, 2가지의 조건부 확률을 계산해보자.          
1. 하나의 A를 가지고 있고, 두 카드 모두 A일 확률                    
2. 두카드 모두 A인데 하나의 카드는 이미 스페이스 A라고 정해졌을 때             

### 1번 풀이
![image](https://user-images.githubusercontent.com/50114210/72443895-65ef0d00-37f2-11ea-8358-c9866a68dc90.png)             

B가 주어졌을 때 A의 확률은 P(both aces, have ace) / P(have ace)
(4C2 / 52C2) / 1 - (48C2 / 52C2)

### 2번 풀이
![image](https://user-images.githubusercontent.com/50114210/72444179-e9106300-37f2-11ea-9910-526214f38321.png)              

스페이스 A를 가지고 있을 때 두장 모두 스페이스일 경우        
두번째 카드는 스페이스 A를 제외한 51장의 카드가 될 수 있다.         

### 문제에 대한 논의 
문제 1에서는 A를 가지고 있다는 것은 하나를 가지고 있다는 것이고            
문제 2의 A는 하나를 완전 특정한 것이다.         
최소한 하나인지 특정한 하나인지에서 오는 차이입니다.          

# 예제 2
질병을 검사한다고 해보자.        
환자가 들어와서 특정 질병 여부를 검사한다고 해보자.         
질병은 인구의 1퍼센트가 걸린다고 한다.        
환자가 검사에서 양성판정을 받았다고 해보자.        
아직 검사가 얼마나 믿을만한건지 모른다.     
95%의 정확도라고 해보자. 이게 무슨의미일까?    


D: 환자가 질병을 가지는 확률        
사건을 정의할때는 최대한 모든 것을 적으려고 해야한다.         
T: 환자가 양성판정을 가지는 확률
위의 두 사건이 우리가 필요한 사건이다.         

95% 정확하다는 의미는
P(T|D) = 0.95 = P(T'|D')      
위 수식의 의미는 환자가 질병을 가지고 있을 때 양성 판정일 확률이 95%       
그리고 환자가 질병을 가지고 있지 않을 때 양성 판정이 아닐 확률이 95%라는 것을 의미한다.           
환자의 질병 보유 여부에 따라 95%의 경우에 올바른 판단을 내란다는 것이 가정          

환자가 관심있는 부분은 본인이 질병을 가지는지 아닌지에 대한 것이다.         
환자가 관심있는 것은 P(T|D)가 아닌 P(D|T)일 것이다.           
통계학을 실생활에 적용할 때 겪는 실수 중하나는 P(T|D)와 P(D|T)를 혼동한다는 것이다.     
이 둘은 완전히 다른 개념이다.       
위의 둘은 베이즈 정리로 연결되어 있다.           

보통 베이즈 법칙과 전체 확률 법칙은 붙어다닌다.         
양성 판정을 받아도 실제로 질병을 가지고 있을 확률은 0.16밖에 안 된다.      
검사가 틀리는게 드물지 질병을 걸리는 사람이 드문지가 경쟁하는 느낌          
베이즈룰은 일관성의 원리를 지닌다.     
어떤 조건에서 정보를 얻든 확률이 같다.        

# 예제3
P(A|B)와  P(B|A)의 혼동 : 검사의 오류       
샐리 클락 사건        
영군인인 샐리클락의 두 아이는 설명되지 않는 이유로 죽게됨         
샐리클락은 살인 죄로 법정에 섰는데       
그녀가 범인이라는 증거는 두 아이가 그냥 죽을 확률이 1/8500 * 1/8500이라는 것          
근데 아이가 죽을 확률들이 독립인지는 생각해봐야함        

### 자주하는 실수 1
또한 우리가 원하는 값은 P(결백함 | 증거)인데          
샐리가 끌려간 이유는 P(증거 | 결백함)이었다.        
결백할 확률이라는 값이 존재하고 사전 확률이 매우 가까울 것이다.       

### 자주하는 실수 2
또한 P(A)와 혼동할 확률, P(A)는 사전확률 P(A|B)는 사후확률           
조건부 확률을 계산할 때 왼쪽과 오른쪽에 무엇이 올지 잘 생각해 봐야한다.        

### 자주하는 실수 3
독립을 조건부 독립과 혼동하는 것         
조건부 독립의 정의: 사건 A와 B가 있을때          
그 둘은 조건부 독립이라고 하자.       
특정 사건 C에 대해 조건부 독립이라고 하자.          
그냥 독립의 정의를 쓴 후에 모든 것이 C의 조건하에서라고 쓰면 된다.          

#### 질문 1: 조건부 독립이 C조건 하에서 비조건부 독립을 의미하는가?        
답은 아니다. 조건부 독립이면 독립일 수도 있고 아닐 수도 있다.        
예)        
만난적 없는 사람이랑 체스를 해보자.        
모든 경기가 독립이라고 해보자.         
시합들이 비 조건부 독립이라고 할 수는 없다.        
이전의 정보가 다음의 정보를 가늠하는 것에 도움을 준다.       
경기 결과는 조건부 독립이지만 독립은 아니다.           
상대의 실력이 주어졌을 때 독립이아니다.        

#### 질문 2: 독립이라면 조건부 독립이라고 할 수 있을까?
만약 아무런 조건 없이 A와 B가 독립이라면,        
C가 주어졌을 때 일반적으로 성립할까?         
정답은 아니다.     
여러가지 현상에 의해 발생하는 경우에 이런 경우가 발생          
예)        
F를 화재 경보가 울리는 사건        
화재경보는 두가지 사건에 의해 발생한다.     
C: 팝콘을 튀기는 경우
F: 실제로 불이 난 경우
팝콘과 불이 나는건 독립이다.       
여기서 구하고 싶은건 불이 났을 확률       
다른 모든 추리를 제거한다면 불이 났을 수 밖에 없다.      
화재 경보가 울렸다는 조건 하에서 조건부 독립은 아닌 것
처음에 둘은 독립이었지만 화재 경보가 울리고 난 뒤에 설명하려면
종속이 된다.        









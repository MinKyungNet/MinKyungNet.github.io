---
layout: post
title: "4강 조건부 확률"
tags: [Independence, pairwise independence, Newton-Pepys Problems, conditional probability, Bayes's Theorem]
categories: [Statistics 110]
---

# 몽모르트 문제
![image](https://user-images.githubusercontent.com/50114210/72363646-822e7380-3738-11ea-8989-81fc03cddf75.png)          

지난 번에 이야기한 몽모르트 문제를 더 살펴보자.    
n장의 카드가 있고 말한 숫자와 카드의 숫자가 같으면 이김       
Aj = j번째 카드에 j라고 적혀있을 확률       
포함 배제 = 모든 사건의 합을 더하고 교집합을 빼주고 겹쳐서 뺀걸 다시 더해주자.           
P(A1 교 A2 교 ... 교 Ak) = (n-k)! / n!         
위의 수식을 몇주간의 계산 없이 풀 수 있는 이유는 대칭성덕임           
형식적으로 하기 위해서는 j를 포함해야했지만,      
대칭성에 의해 하나를 적어도 같게 된다.       
위의 수식의 의미는 위의 몇장의 카드는 순서가 일정해야하지만   
나머지 카드들의 순서는 상관 없다는 뜻이다.       

![image](https://user-images.githubusercontent.com/50114210/72364051-303a1d80-3739-11ea-98fb-4068b3749bdf.png)       

위의 항이 몇개나 존재할까?        
포함배제를 다시보면 크기가 k인 모든 집합에 대해 수행하고   
nCk는 n! / (n-k)! k!       
그래서 nCk만큼의 항이 있고 전부 대칭성에 의해 같을 것이다.     
대칭성과 포함 배제가 이 문제의 핵심        
이제 왜 항들이 상쇄되면서 간단해지는지 알 수 있다.       

![image](https://user-images.githubusercontent.com/50114210/72364299-a3dc2a80-3739-11ea-85b2-5a0b21be2ce8.png)       

이제 포함배제의 원리에의해 합사건의 확률은 다음과 같다.    
P(U 1부터 N까지 Aj) = 1 - 1/2! + 1/3! - ... + (-1)^(n+1) * 1/n!      
1/n!항은 모든 카드가 완벽하게 정렬되어 있다는 의미이다.      

![image](https://user-images.githubusercontent.com/50114210/72364500-fb7a9600-3739-11ea-8e94-5e4ab707750e.png)         

문제를 다르게 표현하면 전부 짝이 맞지 않을 확률로도 나타낼 수 있다.     
1에서 방금 구한것을 뺀것이 될 것이다.     
e^x의 테일러 급수..? 가 떠올라야 한다고 함...        
1/e로 0.37정도 된다고 함      
여기서 n을 무한대로 보냈을 때의 확률을 보통 0이나 1로 말하지만        
근데 1/e로 수렴이 된다.     
앞으로 강의에서 1/e의 형태가 굉장히 자주 나오게 될 것이다.     
이 매칭 예제는 1/e, 대칭성, 포함배제도 등장하는 좋은 예제이다.     

# 독립
![image](https://user-images.githubusercontent.com/50114210/72365446-96c03b00-373b-11ea-8fe9-a0d6e5b10d0f.png)       

정의: 사건 중 하나가 다른 사건에 영향을 주지 않는 것         
실제로 사건이 독립인지 아닌지 판단하기 어려움        
그래서 A, B가 있을 때 다음의 조건을 만족시키면 독립이라고 함     
P(A 교 B) = P(A)P(B)           
A와 B가 동시에 일어날 확률은 A가 일어날 확률 곱하기 B가 일어날 확률      
각 서로가 관계가 없는 것을 말한다.      

### 배반
A와 B가 배반이라고하면 A가 일어났다면 B는 일어날 수 없는 것     

### 여러 사건이 있을 때의 독립    
![image](https://user-images.githubusercontent.com/50114210/72365670-046c6700-373c-11ea-82b2-43022344f11b.png)         

A,B,C가 있고      
P(A 교 B) = P(A)P(B),       
P(B 교 C) = P(B)P(C),
P(A 교 C) = P(A)P(C),
P(A 교 B 교 C) = P(A)P(B)P(C)를 
만족하면 세 사건이 독립이라고 할 수 있다.             
n개가 있어도 이 과정을 반복한다.      
반복이 많기 때문에 지금 해보긴 어렵지만 나중에 다른 방법으로 접근해보자.     

# 뉴턴-피프스 문제         
![image](https://user-images.githubusercontent.com/50114210/72366163-16023e80-373d-11ea-9377-0d8a97466c48.png)        

조건: 육면체의 주사위, 각 면이 나올 확률은 같음           
문제: 다음 세 가지 가능성 중에 어떤 것이 가장 확률이 높을까?        
A: 6개의 주사위중 적어도 하나가 6인 사건                         
B: 12개의 주사위 중 최소 2개의 6                 
C: 18개의 주사위로 적어도 3개의 6          

C가 피프스가 예상한 답이었고 정답은 A었다.         

계산:        
독립을 이용해보자.     
여섯개의 주사위는 독립임      
적어도 하나라는 문구를 보게 되면 합 사건을 떠올라야함     
합사건을 보면 포함배제를 생각하는 것도 좋지만 다른 방법을 적용해보자        

사건A:
여사건을 이용하면 교사건이 될 것이고 독립의 교사건이기 때문에 곱해주기만하면 된다.       
6^6의 가능한 전체 경우가 있고 각 주사위에서 6의 경우를 빼면 5가지 가능한 경우가 있다.      

사건B:          
1에서 6이 없을 확률을 빼준다.        
그리고 6이 하나만 있을 확률도 빼준다.     
이는 정확히 하나의 6과 6이 아닌 11개가 필요하다.      
주사위에 12까지 번호를 붙이고      
하나의 주사위가 6일 확률 곱하기 나머지가 6이 아닐 확률 곱하기       
그리고 각 사건이 일어날 수 있는 12개의 개수를 곱한다.     
모든 주사위가 6이 될 수 있기 때문이다.       


사건C:        
1-(0개, 1개, 2개일때 6이 나올 확률을 빼주기)
6이 어디에 들어갈지 고르는 경우의 수 *      
6인 경우 (1/6)^k     
6이 아닌 경우 (5/6)^(18-k)
위의 확률을 이항 확률이라고 한다.           


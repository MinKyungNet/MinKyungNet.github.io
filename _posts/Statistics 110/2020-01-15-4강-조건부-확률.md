---
layout: post
title: "4강 조건부 확률"
tags: [Independence, pairwise independence, Newton-Pepys Problems, conditional probability, Bayes's Theorem]
categories: [Statistics 110]
---

# 학습 내용
### Independence
정의) P(A 교 B) = P(A)P(B)이 성립할 때, 사건 A와 B는 독립이다.         
주의) 서로소와 구별하기 - A와 B가 서로소인 사건이라면, A가 발생했을 때 B는 발생할 수 없다.             
(한편, A와 B가 독립이라면, 사건 A의 발생은 B의 발생여부에 대한 그 어떤 영향도 끼치지 않음)

### 예제
Newton-Pepys Problem        
공정한 주사위를 갖고 있을 때, 다음 중 어떤 경우가 발생할 확률이 가장 높은가?          
a) 6개의 주사위 중에서 적어도 한 개가 '6'이 나온 경우
b) 12개의 주사위 중에서 적어도 두 개가 '6'이 나온 경우
c) 18개의 주사위 중에서 적어도 세 개가 '6'이 나온 경우
답은 a

풀이)          
'적어도 몇 개'라는 표현이 나오면 합집합을 생각하기          
합집한은 여집합의 교집합          
모든 사건이 독립이기 때문에, 곱셈으로 구할 수 있음!
![image](https://user-images.githubusercontent.com/50114210/72440690-a5b2f600-37ec-11ea-8474-ff205c9423e7.png)           

### Conditional Probability        
새로운 정보를 얻었을 때, 기존의 '믿음 / 불확실성'을 어떻게 업데이트 하는가?         
정의) P(A|B) = P(A교B) / P(B), (P(B) > 0이다.)      

### 직관적 접근 1) 조약돌 세계관
![image](https://user-images.githubusercontent.com/50114210/72440788-dbf07580-37ec-11ea-9ccb-f67a95c85401.png)             
![image](https://user-images.githubusercontent.com/50114210/72440806-e1e65680-37ec-11ea-80c6-7fee8a795a89.png)

### 직관적 접근 2) 빈도학파 세계관
같은 실험을 무한 번 반복할 수 있다면,
![image](https://user-images.githubusercontent.com/50114210/72440847-f1fe3600-37ec-11ea-892c-832180813201.png)

### 정리
![image](https://user-images.githubusercontent.com/50114210/72440881-017d7f00-37ed-11ea-8ae8-21330925984c.png)              

# 몽모르트 문제
![image](https://user-images.githubusercontent.com/50114210/72363646-822e7380-3738-11ea-8989-81fc03cddf75.png)          

지난 번에 이야기한 몽모르트 문제를 더 살펴보자.    
n장의 카드가 있고 말한 숫자와 카드의 숫자가 같으면 이김       
Aj = j번째 카드에 j라고 적혀있을 확률       
포함 배제 = 모든 사건의 합을 더하고 교집합을 빼주고 겹쳐서 뺀걸 다시 더해주자.           
P(A1 교 A2 교 ... 교 Ak) = (n-k)! / n!         
위의 수식을 몇주간의 계산 없이 풀 수 있는 이유는 대칭성덕임           
형식적으로 하기 위해서는 j를 포함해야했지만,      
대칭성에 의해 하나를 적어도 같게 된다.       
위의 수식의 의미는 위의 몇장의 카드는 순서가 일정해야하지만   
나머지 카드들의 순서는 상관 없다는 뜻이다.       

![image](https://user-images.githubusercontent.com/50114210/72364051-303a1d80-3739-11ea-98fb-4068b3749bdf.png)       

위의 항이 몇개나 존재할까?        
포함배제를 다시보면 크기가 k인 모든 집합에 대해 수행하고   
nCk는 n! / (n-k)! k!       
그래서 nCk만큼의 항이 있고 전부 대칭성에 의해 같을 것이다.     
대칭성과 포함 배제가 이 문제의 핵심        
이제 왜 항들이 상쇄되면서 간단해지는지 알 수 있다.       

![image](https://user-images.githubusercontent.com/50114210/72364299-a3dc2a80-3739-11ea-85b2-5a0b21be2ce8.png)       

이제 포함배제의 원리에의해 합사건의 확률은 다음과 같다.    
P(U 1부터 N까지 Aj) = 1 - 1/2! + 1/3! - ... + (-1)^(n+1) * 1/n!      
1/n!항은 모든 카드가 완벽하게 정렬되어 있다는 의미이다.      

![image](https://user-images.githubusercontent.com/50114210/72364500-fb7a9600-3739-11ea-8e94-5e4ab707750e.png)         

문제를 다르게 표현하면 전부 짝이 맞지 않을 확률로도 나타낼 수 있다.     
1에서 방금 구한것을 뺀것이 될 것이다.     
e^x의 테일러 급수..? 가 떠올라야 한다고 함...        
1/e로 0.37정도 된다고 함      
여기서 n을 무한대로 보냈을 때의 확률을 보통 0이나 1로 말하지만        
근데 1/e로 수렴이 된다.     
앞으로 강의에서 1/e의 형태가 굉장히 자주 나오게 될 것이다.     
이 매칭 예제는 1/e, 대칭성, 포함배제도 등장하는 좋은 예제이다.     

# 독립
![image](https://user-images.githubusercontent.com/50114210/72365446-96c03b00-373b-11ea-8fe9-a0d6e5b10d0f.png)       

정의: 사건 중 하나가 다른 사건에 영향을 주지 않는 것         
실제로 사건이 독립인지 아닌지 판단하기 어려움        
그래서 A, B가 있을 때 다음의 조건을 만족시키면 독립이라고 함     
P(A 교 B) = P(A)P(B)           
A와 B가 동시에 일어날 확률은 A가 일어날 확률 곱하기 B가 일어날 확률      
각 서로가 관계가 없는 것을 말한다.      

### 배반
A와 B가 배반이라고하면 A가 일어났다면 B는 일어날 수 없는 것     

### 여러 사건이 있을 때의 독립    
![image](https://user-images.githubusercontent.com/50114210/72365670-046c6700-373c-11ea-82b2-43022344f11b.png)         

A,B,C가 있고      
P(A 교 B) = P(A)P(B),       
P(B 교 C) = P(B)P(C),
P(A 교 C) = P(A)P(C),
P(A 교 B 교 C) = P(A)P(B)P(C)를 
만족하면 세 사건이 독립이라고 할 수 있다.             
n개가 있어도 이 과정을 반복한다.      
반복이 많기 때문에 지금 해보긴 어렵지만 나중에 다른 방법으로 접근해보자.     

# 뉴턴-피프스 문제         
![image](https://user-images.githubusercontent.com/50114210/72366163-16023e80-373d-11ea-9377-0d8a97466c48.png)        

조건: 육면체의 주사위, 각 면이 나올 확률은 같음           
문제: 다음 세 가지 가능성 중에 어떤 것이 가장 확률이 높을까?        
A: 6개의 주사위중 적어도 하나가 6인 사건                         
B: 12개의 주사위 중 최소 2개의 6                 
C: 18개의 주사위로 적어도 3개의 6          

C가 피프스가 예상한 답이었고 정답은 A었다.         

계산:        
독립을 이용해보자.     
여섯개의 주사위는 독립임      
적어도 하나라는 문구를 보게 되면 합 사건을 떠올라야함     
합사건을 보면 포함배제를 생각하는 것도 좋지만 다른 방법을 적용해보자        

사건A:
여사건을 이용하면 교사건이 될 것이고 독립의 교사건이기 때문에 곱해주기만하면 된다.       
6^6의 가능한 전체 경우가 있고 각 주사위에서 6의 경우를 빼면 5가지 가능한 경우가 있다.      

사건B:          
1에서 6이 없을 확률을 빼준다.        
그리고 6이 하나만 있을 확률도 빼준다.     
이는 정확히 하나의 6과 6이 아닌 11개가 필요하다.      
주사위에 12까지 번호를 붙이고      
하나의 주사위가 6일 확률 곱하기 나머지가 6이 아닐 확률 곱하기       
그리고 각 사건이 일어날 수 있는 12개의 개수를 곱한다.     
모든 주사위가 6이 될 수 있기 때문이다.       


사건C:        
1-(0개, 1개, 2개일때 6이 나올 확률을 빼주기)
6이 어디에 들어갈지 고르는 경우의 수 *      
6인 경우 (1/6)^k     
6이 아닌 경우 (5/6)^(18-k)
위의 확률을 이항 확률이라고 한다.           

# 조건부 확률
![image](https://user-images.githubusercontent.com/50114210/72437510-376b3500-37e6-11ea-99e4-ee19c6e8b10e.png)               

제기하려는 문제 실제 상황에서는 삶을 살아가면서 매일 새로운 것들을 배우게 된다.            
우리는 많은 것에대한 불확실성을 가지고있지만 매일 새로운 것을 배운다.        
질문은 이렇게 새롭게 배운 것을 가지고 어떻게 불확실성과 확률을 갱신할 것이냐는 것입니다.            
믿음을 어떻게 갱신하는가? 확률 믿음 불확실성을           
매우 중요한 개념이다.          

![image](https://user-images.githubusercontent.com/50114210/72437882-0ccdac00-37e7-11ea-88fd-e18ae1d2d499.png)             
        
정의: P(A|B), B가 주어졌을 때 A가 일어날 확률            
A와 B가 독립이라면 조건부 확률은 가치가 없는 정보가 되겠지만             
A와 B가 독립이 아니라면 굉장히 가치있는 정보가 된다.          
그러면 나오는 질문이 A가 일어날 확률을 어떻게 갱신할 것인가에 대한 문제가 된다.         

계산: P(A 교 B) / P(B), if P(B) > 0            

### 조건부 확률에 대한 직관1, 조약돌 세기
![image](https://user-images.githubusercontent.com/50114210/72438333-ee1be500-37e7-11ea-8484-dd221bd38f97.png)             

조약돌들의 제약조건은 합이 1         
사건은 부분집합일 뿐이다.        
B가 이미 일어났다고 가정하고         
그러니까 B에 포함되지 않은 조약돌, B'을 모두지우고       
남은 조약돌 중에 A에 있던것 들 중 B랑 겹치는 것 P(A 교 B)           
왜 P(B)로 나눌까?         
B 밖에 있는 조약돌을 지우고 이전에 하던것처럼하면         
합이 1이되지 않으니 정규화를 해주는 것이다.             
전체 질량이 1이 되도록 정규화           

### 조건부 확률에 대한 직관2, 빈도학파 세계 
![image](https://user-images.githubusercontent.com/50114210/72438731-cda05a80-37e8-11ea-91d6-dcc67345ab1d.png)              

빈도학파는 실험을 한번만 하지 않고 여러번 반복한다.           
각 시행에 대한 리스트를 만들어보자.       
이진 데이터를 만들어낸다고 해보자.        
B가 발생한 시점에 원을그리자.          
많은 시행을 반복하면서 B가 일어난걸 확인하고       
A도 같이 일어난 것을 확인하자.         

# 이론
### 이론1          
A와 B의 확률을 구하고 싶다고 할 때         
그 확률을 어떻게 구할까?          
P(A교B) = P(B)P(A|B) = P(A)P(B|A)         

### 이론2
P(A1...An) = P(A1)P(A2|A1)P(A3|A2)...P(An|An-1)            
이는 하나의 정리가 아닌 n!개의 정리이다.         

### 이론3
P(A|B) = (P(B|A)P(A))/P(B)         
이 정리는 베이즈 정리라고한다.           
함축하는 깊이가 꽤 깊다.           
 
